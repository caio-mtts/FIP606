{
  "hash": "4f8116a148b9cf8d00ba1897837d8148",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Estatísticas descritivas e criação de gráficos simples\"\nauthor: \"Caio\"\nformat: html\neditor: visual\neditor_options: \n  chunk_output_type: console\nexecute:\n  warning: false\n  error: false\n---\n\n\n# Aula 3\n\nNesa aula, serão apresentadas ferramentas para se realizar uma análise descritiva do conjunto de dados. Além disso, o pacote **`tidyverse`** será utilizado para manipulação, criação de subconjuntos e organização dos dados. Por fim, ao longo da aula será demonstrado como criar gráficos simples.\n\n## Carregando pacotes, importando os dados e resumo estatístico\n\nPrimeiro, será feito o carregamento dos pacotes:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(ggthemes)\nlibrary(patchwork)\n```\n:::\n\n\n\\\nOs dados utlizados serão importados de um arquivo .csv disponível em nuvem.\\\nResumidamente, o arquivo traz valores de incidência e severidade da ferrugem do cafeeiro em diferentes regiões da Etiópia, de acordo com o sistema de cultivo, manejo da fazenda, sombreamento, cultivar, etc.:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncr <- read_csv(\"https://raw.githubusercontent.com/emdelponte/paper-coffee-rust-Ethiopia/master/data/survey_clean.csv\")\n```\n:::\n\n\n\\\nPara uma visualização rápida dos dados, será utilizada a função `glimpse`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(cr)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 405\nColumns: 13\n$ farm            <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,…\n$ region          <chr> \"SNNPR\", \"SNNPR\", \"SNNPR\", \"SNNPR\", \"SNNPR\", \"SNNPR\", …\n$ zone            <chr> \"Bench Maji\", \"Bench Maji\", \"Bench Maji\", \"Bench Maji\"…\n$ district        <chr> \"Debub Bench\", \"Debub Bench\", \"Debub Bench\", \"Debub Be…\n$ lon             <dbl> 35.44250, 35.44250, 35.42861, 35.42861, 35.42861, 35.3…\n$ lat             <dbl> 6.904722, 6.904722, 6.904444, 6.904444, 6.904444, 6.90…\n$ altitude        <dbl> 1100, 1342, 1434, 1100, 1400, 1342, 1432, 1100, 1400, …\n$ cultivar        <chr> \"Local\", \"Mixture\", \"Mixture\", \"Local\", \"Local\", \"Mixt…\n$ shade           <chr> \"Sun\", \"Mid shade\", \"Mid shade\", \"Sun\", \"Sun\", \"Mid sh…\n$ cropping_system <chr> \"Plantation\", \"Plantation\", \"Plantation\", \"Plantation\"…\n$ farm_management <chr> \"Unmanaged\", \"Minimal\", \"Minimal\", \"Unmanaged\", \"Unman…\n$ inc             <dbl> 86.70805, 51.34354, 43.20000, 76.70805, 47.15808, 51.3…\n$ sev2            <dbl> 55.57986, 17.90349, 8.25120, 46.10154, 12.25167, 19.91…\n```\n\n\n:::\n:::\n\n\n\\\nA seguir, uma breve descrição estatística dos valores de incidência, com uso da função `summary`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(cr$inc)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   9.50   19.43   32.50   34.89   48.20   86.71 \n```\n\n\n:::\n:::\n\n\n\\\nDos valores de severidade, com uso da função `summary`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(cr$sev2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n 0.2248  2.6892  5.9490  9.0945 12.1593 55.5799 \n```\n\n\n:::\n:::\n\n\n## Resumo gráfico geral do dataset\n\nPara uma visualização gráfica dos valores de incidência será criado um histograma:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncr %>%\n  ggplot(aes(x = inc))+\n  geom_histogram ()\n```\n\n::: {.cell-output-display}\n![](Aula-3_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\\\nNo histograma gerado, é possível notar que os valores de incidência apresentam três picos (ou seja, são valores de incidência com maior frequência). Além disso, a incidência aparenta não seguir distribuição normal, uma vez que o histograma apresenta um deslocamento à esquerda.\n\n\\\nÉ possível criar histogramas por algum critério, por exemplo, as regiões.\\\nPara isso, será utilizada a função **`facet_wrap`**:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncr %>% ggplot(aes(x = inc))+\n  geom_histogram()+\n  facet_wrap(~region)\n```\n\n::: {.cell-output-display}\n![](Aula-3_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nAo analisar os histogramas em função das regiões, é possível notar que na região de Oromia, os valores de incidência são mais frequentes em torno do centro da distribuição. Já na região de SNNPR, as incidências mais frequentes são inferiores a 25%.\n\n\\\nTambém serão criados boxplots, divididos por regiões:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncr %>% ggplot(aes(x = inc,))+\n  geom_boxplot()+\n  facet_wrap(~region)+\n  coord_flip()+\n  labs (x = \"Incidence (%)\")\n```\n\n::: {.cell-output-display}\n![](Aula-3_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n## Estatistícas descritivas dos dados por variável\n\nPara o agrupamento dos valores em função de uma variável, utiliza-se a função `group_by`:\n\n### Análise da incidência\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncr %>% group_by(cultivar) %>% \n  summarise(inc_mean = mean(inc),\n            inc_median = median(inc),\n            sd_mean = sd(inc))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 4\n  cultivar inc_mean inc_median sd_mean\n  <chr>       <dbl>      <dbl>   <dbl>\n1 Improved     16.4       15.2    5.66\n2 Local        53.4       50.9   14.3 \n3 Mixture      31.9       31.6   11.2 \n```\n\n\n:::\n:::\n\n\n### Comparação da incidência *versus* severidade\n\nPara avaliar a correlação de duas variáveis respostas, é possível lançar mão de um gráfico de pontos, plotando nos eixos as variáveis desejadas:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncr %>% \n  ggplot(aes(x = inc, y = sev2))+\n  geom_point()+\n  labs(x = \"Incidence (%)\",\n       y = \"Severity (%)\")\n```\n\n::: {.cell-output-display}\n![](Aula-3_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nNo gráfico gerado é possível observar que há alta correlação positiva entre as variáveis severidade e incidência.\\\n\\\n\n### Análise da severidade\n\nSerão realizadas análises de severidade em função da região e, em seguida, da cultivar. Para isso, a função `group_by` será utilizada mais uma vez.\\\n\\\n\n#### Severidade por região\n\nPara conhecer a média, desvio-padrão e mediana será utilizada a função `summarise`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncr %>% group_by(region) %>% \n  summarise(mean_sev = mean(sev2),\n            med_sev = median(sev2),\n            sev_sd = sd(sev2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 4\n  region mean_sev med_sev sev_sd\n  <chr>     <dbl>   <dbl>  <dbl>\n1 Oromia     8.06    6.23   6.82\n2 SNNPR      9.81    4.88  10.5 \n```\n\n\n:::\n:::\n\n\n\\\nEm sequência, serão gerados histogramas por região utilizado a função `face_wrap`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncr %>% \n  ggplot(aes(sev2))+\n  geom_histogram()+\n  facet_wrap(~region)\n```\n\n::: {.cell-output-display}\n![](Aula-3_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n#### Severidade por cultivar\n\nSeguindo a mesma lógica do item anterior, será feito avaliação da severidade por cultivares:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncr %>%\n  group_by(cultivar) %>%\n  summarise(mean_sev = mean(sev2),\n            med_sev = median(sev2),\n            sd_sev = sd(sev2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 4\n  cultivar mean_sev med_sev sd_sev\n  <chr>       <dbl>   <dbl>  <dbl>\n1 Improved     2.16    1.64   1.82\n2 Local       18.7    17.2   11.1 \n3 Mixture      6.47    5.43   4.35\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncr %>%\n  ggplot(aes(sev2))+\n  geom_histogram()+\n  facet_wrap(~cultivar)\n```\n\n::: {.cell-output-display}\n![](Aula-3_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n#### Severidade por região e cultivar\n\nAgora, será gerado um histograma da severidade em função de duas variáveis independentes, a região e a cultivar. Nesse caso, primeiro será utilizada a função `facet_wrap` e depois a função `facet_grid`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncr %>% ggplot(aes(x = sev2))+\n  geom_histogram()+\n  facet_wrap(region ~ cultivar)\n```\n\n::: {.cell-output-display}\n![](Aula-3_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncr %>%\n  ggplot(aes(sev2))+\n  geom_histogram()+\n  facet_grid(~region~cultivar)\n```\n\n::: {.cell-output-display}\n![](Aula-3_files/figure-html/unnamed-chunk-15-2.png){width=672}\n:::\n:::\n\n\nÉ possível notar que com a função `facet_grid`, o plot se torna mais harmônico...\\\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng1 <- cr %>% ggplot(aes(x = sev2, fill = region))+\n  geom_histogram(color = \"white\")+\n  facet_grid(region ~ cultivar)+\n  #scale_fill_manual(values = c(\"blue\", \"red\"))+ #Para atribuir cores manualmente.\n  theme(legend.position = \"bottom\")+\n  labs(x = \"Frequency\",\n       y = \"Severity (%)\",\n       fill = \"Region\")\n```\n:::\n\n\n\\\nPara salvar o plot gerado:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggsave(\"cr.png\", bg = \"white\")\n```\n:::\n\n\n## Criando subconjuntos\n\nPara criação de subconjuntos, serão utilizadas duas funções: `select` e `filter`.\\\nA função `select` faz seleção das colunas em que se deseja trabalhar. Para utilizar essa função, basta colocar como argumentos os títulos das colunas que serão selecionadas.\n\njá a função `filter` é responsável por buscar e filtrar, nas linhas, uma informação de interesse. Nesse caso, inicialmente é preciso indicar em qual coluna será feito o filtro, em seguida é indicada a informação de interesse.\\\nImportante: para o que software busque essa informação é preciso utilizar `==`.\\\n\\\n\\\nSerão criados dois subconjuntos apresentando a severidade em função das regiões.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nOromia <- cr %>% \n  select(farm, region, cultivar, sev2) %>%\n  filter(region == \"Oromia\")\n\nSNPPR <- cr %>%\n  select(farm, region, cultivar, sev2) %>%\n  filter(region == \"SNNPR\")\n```\n:::\n\n\n### Visualizando os subconjuntos graficamente:\n\nPara visualizar os subconjuntos recém-criados:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng1 <- Oromia %>%\n  ggplot(aes(cultivar, sev2, fill = cultivar))+\n  geom_boxplot()+\n  labs(title = \"Oromia\",\n     x = \"Cultivar\",\n     y = \"Severity (%)\")\ng1\n```\n\n::: {.cell-output-display}\n![](Aula-3_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n\n```{.r .cell-code}\ng2 <- SNPPR %>%\n  ggplot(aes(cultivar, sev2, fill = cultivar))+\n  geom_boxplot()+\n  labs(title = \"SNPPR\",\n     x = \"Cultivar\",\n     y = \"Severity (%)\")\ng2\n```\n\n::: {.cell-output-display}\n![](Aula-3_files/figure-html/unnamed-chunk-19-2.png){width=672}\n:::\n:::\n\n\n### Criando uma figura combinando os dois gráficos\n\nPara criar uma figura combinando os dois gráficos gerados anteriormente, será utilizado o pacote `patchwork`. É possível plotar um gráfico sobre outro\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(g1/g2) + plot_layout(guides = \"collect\")\n```\n\n::: {.cell-output-display}\n![](Aula-3_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\nOu então um gráfico ao lado do outro\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(g1+g2) + \n  plot_layout(guides = \"collect\")+\n  plot_annotation(tag_levels = \"A\") #Para deixar mais apresentável, é possível                                          remover o título colocado no gráfico                                               anteriormente.\n```\n\n::: {.cell-output-display}\n![](Aula-3_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\nTambém é possível inverter o modo como o boxplot é plotado, utilizando a função `coord_flip`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng3 <- Oromia %>% \n  ggplot(aes(cultivar, sev2, fill = cultivar))+\n  geom_boxplot()+\nlabs(x = \"\",\n     y = \"Severity (%)\")+\n  theme_classic()+\n  coord_flip()\ng3\n```\n\n::: {.cell-output-display}\n![](Aula-3_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n\n```{.r .cell-code}\ng4 <- SNPPR %>% \n  ggplot(aes(cultivar, sev2, fill = cultivar))+\n  geom_boxplot()+\nlabs(x = \"\",\n     y = \"Severity (%)\")+\n  theme_classic()+\n  coord_flip()\ng4\n```\n\n::: {.cell-output-display}\n![](Aula-3_files/figure-html/unnamed-chunk-22-2.png){width=672}\n:::\n\n```{.r .cell-code}\n(g3 / g4) + \n  plot_layout(guides = \"collect\", axis_titles = \"collect\")+\n  plot_annotation(title = \"Severity of coffee leaf rust in Ethiopia\",\n                   tag_levels = \"A\")\n```\n\n::: {.cell-output-display}\n![](Aula-3_files/figure-html/unnamed-chunk-22-3.png){width=672}\n:::\n:::\n\n\nPara o salvar o gráfico criado:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggsave(\"grap2.png\", width = 10, height = 8)\n```\n:::\n\n\nAlém disso, o pacote `patchwork` permite plotar um gráfico dentro do outro.\\\nPor exemplo, será criado uma figura apresentando um boxplot da severidade da ferrugem na região de Oromia em função das cultivares e também será apresentado um histograma da severidade nesta região:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng5 <- Oromia %>% \n  ggplot(aes(cultivar, sev2, fill = cultivar))+\n  geom_boxplot()+\nlabs(x = \"\",\n     y = \"Severity (%)\",\n     fill = \"Cultivar\")+\n  theme_classic()+\n  coord_flip()\ng5\n```\n\n::: {.cell-output-display}\n![](Aula-3_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n\n```{.r .cell-code}\ng6 <- Oromia %>% \n  ggplot(aes(x = sev2))+\n  geom_histogram()+\n  labs(x = \"\", y = \"\")+\n  theme_classic()\ng6\n```\n\n::: {.cell-output-display}\n![](Aula-3_files/figure-html/unnamed-chunk-24-2.png){width=672}\n:::\n\n```{.r .cell-code}\ng5 + inset_element(g6, left = 0.5, bottom = 0.5, right = 1, top = 1)\n```\n\n::: {.cell-output-display}\n![](Aula-3_files/figure-html/unnamed-chunk-24-3.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}