{
  "hash": "21ea1cd23b18039648e416303fb4b7a5",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Aula 6\"\nformat: html\neditor: visual\nexecute: \n  error: false\n  warning: false\neditor_options: \n  chunk_output_type: console\n---\n\n\nNesta aula serão apresentados alguns passos para condução da estatística inferencial. Inicialmente, serão conduzidos teste-t e, brevemente, alguns passos para realizar uma análise de variância (ANOVA).\n\n# Carregando os pacotes\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gsheet)\nlibrary(tidyverse)\nlibrary(report)\n```\n:::\n\n\nPacotes utilizados para realizar ANOVA:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(emmeans)\nlibrary(multcomp)\nlibrary(multcompView)\nlibrary(DHARMa)\nlibrary(performance)\n```\n:::\n\n\n# Análise inferencial - Teste t\n\n## Obtenção dos dados\n\nOs dados serão importados de uma planilha online, utilizado a ferramenta `gsheet2tbl` (**`gsheet`**). O conjunto de dados é referente a avaliação do efeito da suplementação de magnésio (Mg~2~) sobre o comprimento de lesões.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmg <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=983033137\")\n\nglimpse(mg)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 20\nColumns: 3\n$ trat <chr> \"Mg2\", \"Mg2\", \"Mg2\", \"Mg2\", \"Mg2\", \"Mg2\", \"Mg2\", \"Mg2\", \"Mg2\", \"M…\n$ rep  <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10\n$ comp <dbl> 9.00, 12.50, 10.00, 8.00, 13.20, 11.00, 10.80, 9.50, 10.80, 10.40…\n```\n\n\n:::\n:::\n\n\n## Análise dos dados\n\nInicialmente, será feito um gráfico do tipo boxplot para analisarmos o conjunto de dados visualmente.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmg %>% \n  ggplot(aes(trat, comp))+\n  geom_boxplot(width = 0.5)\n```\n\n::: {.cell-output-display}\n![](Aula-6.1_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nO gráfico gerado sugere que há diferença no tamanho das lesões em função do tratamento avaliado. Onde a suplementação com Mg~2~ parece possuir efeito desejável, reduzindo o comprimento das lesões.\\\nAlém, o gráfico indica que os dados possuem distribuição normal, pois há simetria em ambos os retângulos; e que também homocedasticidade (homogeneidade das variâncias), já que os dois retângulos possuem tamanho semelhante.\n\n## Conversão dos dados\n\nAntes de realizar o teste-t será preciso transformar a tabela para o formato largo (cada tratamento em uma coluna), para isso será utilizada a função `pivot_wider` (**`tidyr`**):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmg2 <- mg %>%\n  pivot_wider(names_from = trat,\n              values_from = comp)\n\nglimpse(mg2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 10\nColumns: 3\n$ rep     <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10\n$ Mg2     <dbl> 9.0, 12.5, 10.0, 8.0, 13.2, 11.0, 10.8, 9.5, 10.8, 10.4\n$ control <dbl> 13.72, 15.91, 15.70, 14.20, 15.90, 16.54, 18.00, 14.40, 16.41,…\n```\n\n\n:::\n:::\n\n\n## Teste-t\n\n### Teste-t para duas amostras independentes\n\nCom base no conjunto de dados recém transformado, será feito um teste t (função `t.test`, nativa do R) para duas amostras independentes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(mg2$Mg2, mg2$control)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  mg2$Mg2 and mg2$control\nt = -8.1549, df = 17.354, p-value = 2.423e-07\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -6.490393 -3.825607\nsample estimates:\nmean of x mean of y \n   10.520    15.678 \n```\n\n\n:::\n:::\n\n\nA partir do resultado do teste, podemos concluir há diferença significativa entre os tratamentos, pois o valor de P foi extretamente baixo (\\< 0.01).\n\n#### Verificação das premissas\n\nPara termos confiança no teste realizado é preciso saber se os dados atendem algumas premissas: se há normalidade entre os conjuntos; e se os conjuntos possuem mesma variância.\n\n#### Teste de normalidade:\n\n-   Histogramas\\\n    Uma forma de se avaliar a normalidade visualmente é por meio de histograma:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(mg2$control)\n```\n\n::: {.cell-output-display}\n![](Aula-6.1_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(mg2$Mg2)\n```\n\n::: {.cell-output-display}\n![](Aula-6.1_files/figure-html/unnamed-chunk-7-2.png){width=672}\n:::\n:::\n\n\n-   Q-Q Plot de normalidade\n\n    Outra opção é por meio de Q-Q plots:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqqnorm(mg2$control)\nqqline(mg2$control)\n```\n\n::: {.cell-output-display}\n![](Aula-6.1_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nqqnorm(mg2$Mg2)\nqqline(mg2$Mg2)\n```\n\n::: {.cell-output-display}\n![](Aula-6.1_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n-   Avaliação estatística\n\n    A avaliação também pode ser feita utilizando testes estatísticos. Nesse caso, será aplicada a função `shapiro.test` (nativa do R):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(mg2$control)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  mg2$control\nW = 0.93886, p-value = 0.5404\n```\n\n\n:::\n\n```{.r .cell-code}\nshapiro.test(mg2$Mg2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  mg2$Mg2\nW = 0.97269, p-value = 0.9146\n```\n\n\n:::\n:::\n\n\nAmbas as metodologias demonstram que os dados possuem distribuição normal. Os histogramas possuem formato típico de um conjunto de dados normais. Nos Q-Q Plots, é possível notar que os pontos estão próximo a linha de normalidade. E pelos testes de Shapiro Wilk, não se rejeita a hipótese nula (de normalidade), já que valor de P é maior que o nível de significância adotado (⍺ = 5%).\n\n#### Teste de homogeneidade\n\nPara avaliação da homogeneidade entre as variâncias será utilizada a função `var.test` (também nativa do R):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvar.test(mg2$control, mg2$Mg2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tF test to compare two variances\n\ndata:  mg2$control and mg2$Mg2\nF = 0.67654, num df = 9, denom df = 9, p-value = 0.5698\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.1680428 2.7237436\nsample estimates:\nratio of variances \n         0.6765394 \n```\n\n\n:::\n:::\n\n\nCom o resultado do teste não rejeitamos a hipótese nula (de homogeneidade entre as amostras), pois o valor de probabilidade é superior a 5%. Logo, os tratamentos possuem mesma variância.\\\n\\\nCom isso (dados normais, com variâncias homogêneas), podemos confiar no teste-t realizado.\n\n#### Apresentação dos resultados\n\nA função `report` (**`report`**) pode ser utilizada para gerar um modelo de texto, reportando os resultados obtidos. Para isso atribuímos o teste-t a um objeto e em sequência executamos a função.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nteste1 <- t.test(mg2$Mg2, mg2$control)\nreport(teste1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nEffect sizes were labelled following Cohen's (1988) recommendations.\n\nThe Welch Two Sample t-test testing the difference between mg2$Mg2 and\nmg2$control (mean of x = 10.52, mean of y = 15.68) suggests that the effect is\nnegative, statistically significant, and large (difference = -5.16, 95% CI\n[-6.49, -3.83], t(17.35) = -8.15, p < .001; Cohen's d = -3.65, 95% CI [-5.12,\n-2.14])\n```\n\n\n:::\n:::\n\n\n### Teste-t para duas amostras dependentes\n\nPara demonstrar a aplicação do test-t pareado (ou para amostras dependentes), utilizaremos um conjunto de dados no qual há resultados de avaliação de doenças antes e após o uso de uma escala de doenças, logo o objetivo será determinar se o uso da escala desempenha algum efeito sobre as avaliações.\\\n\n### Quando há distribuição normal\n\n#### Obtenção, visualização e seleção dos dados\n\nOs dados serão obtidos de uma planilha excel:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nescala <- readxl::read_excel(\"dados-diversos.xlsx\",\n                             sheet = \"escala\")\n\nglimpse(escala)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 20\nColumns: 7\n$ assessment       <chr> \"Unaided\", \"Unaided\", \"Unaided\", \"Unaided\", \"Unaided\"…\n$ rater            <chr> \"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\", \"A\"…\n$ acuracia         <dbl> 0.8092131, 0.7219848, 0.5595983, 0.8175313, 0.7476691…\n$ precisao         <dbl> 0.8262697, 0.7284040, 0.7149415, 0.8187018, 0.7532589…\n$ vies_geral       <dbl> 0.9793570, 0.9911874, 0.7827190, 0.9985702, 0.9925792…\n$ vies_sistematico <dbl> 1.1872167, 0.9217054, 1.1600785, 0.9481874, 1.1038873…\n$ vies_constante   <dbl> 0.1123982, -0.1055045, 0.7301412, -0.0056930, 0.07194…\n```\n\n\n:::\n:::\n\n\nEm seguida, será feito um boxplot para rápida visualização do conjunto de dados:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nescala %>%\n  ggplot(aes(assessment, acuracia))+\n  geom_boxplot(width = 0.4)\n```\n\n::: {.cell-output-display}\n![](Aula-6.1_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\nPara condução dos testes, serão selecionadas as colunas \"assessment\", \"rater\" e \"acuracia\", que serão colocados no formato largo.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nescala2 <- escala %>%\n  dplyr::select( assessment, rater, acuracia) %>% \n  pivot_wider(names_from = assessment,\n              values_from = acuracia)\n\nglimpse(escala2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 10\nColumns: 3\n$ rater   <chr> \"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\"\n$ Unaided <dbl> 0.8092131, 0.7219848, 0.5595983, 0.8175313, 0.7476691, 0.69491…\n$ Aided1  <dbl> 0.9067211, 0.9126980, 0.9148087, 0.9598576, 0.9593181, 0.90277…\n```\n\n\n:::\n:::\n\n\n#### Testar as premissas\n\n#### Teste de normalidade\n\nA avaliação da normalidade será feita estatisticamente, pelo teste de Shapiro Wilk, com valor de significância (⍺) de 5%:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(escala2$Unaided)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  escala2$Unaided\nW = 0.87462, p-value = 0.1131\n```\n\n\n:::\n\n```{.r .cell-code}\nshapiro.test(escala2$Aided1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  escala2$Aided1\nW = 0.92775, p-value = 0.4261\n```\n\n\n:::\n:::\n\n\nPara ambos os tratamentos há normalidade, já que os valores de P foram superiores a 5%.\\\n\n#### Teste de homogeneidade\n\nPara avaliação da homogeneidade entre as variâncias, usaremos o teste de variância:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvar.test(escala2$Unaided, escala2$Aided1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tF test to compare two variances\n\ndata:  escala2$Unaided and escala2$Aided1\nF = 5.8683, num df = 9, denom df = 9, p-value = 0.01461\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n  1.457601 23.625712\nsample estimates:\nratio of variances \n          5.868293 \n```\n\n\n:::\n:::\n\n\nO teste de variância demonstra que não há homogeneidade entre os conjuntos de dados, pois o valor de P é menor que 0,05 (5%). Logo, será preciso indicar no teste t que há heterogeneidade.\\\n\n#### Teste t pareado\n\nComo demonstrado acima, os dados possuem distribuição normal, portanto ainda é possível utilizar um teste paramétrico. No entanto, não há homogeneidade de variâncias, o que precisará ser indicado na construção da função.\n\nPara executar o teste t pareado utiliza-se a mesma função (`t.test`), incluindo dois parâmetros:\n\n-   `paired = TRUE`, para indicar amostras dependentes (ou pareadas);\n\n-   e `var.equal = FALSE` , para indicar heterocedasticidade.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(escala2$Aided1,escala2$Unaided,\n       paired = TRUE,\n       var.equal = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPaired t-test\n\ndata:  escala2$Aided1 and escala2$Unaided\nt = 5.9364, df = 9, p-value = 0.000219\nalternative hypothesis: true mean difference is not equal to 0\n95 percent confidence interval:\n 0.1144707 0.2554241\nsample estimates:\nmean difference \n      0.1849474 \n```\n\n\n:::\n:::\n\n\nCom o teste, é possível concluir que o uso da escala teve efeito sobre a acurácia dos avaliadores (P-valor = 0.000219), onde foi perceptível um aumento de acurácia após o uso da assistência.\\\n\n### Quando **não** há distribuição normal: teste não paramétrico\n\nPara demonstrar essa situação será utilizado um conjunto de dados similar ao exemplo anterior. No entanto, com alguns valores alterados para não possuir mais distribuição normal.\n\n#### Obtenção, visualização e seleção dos dados\n\n\n::: {.cell}\n\n```{.r .cell-code}\nescala3 <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1729131173\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nescala3 %>%\n  ggplot(aes(assessment, acuracia))+\n  geom_boxplot(width = 0.4)\n```\n\n::: {.cell-output-display}\n![](Aula-6.1_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nescala4 <- escala3 %>%\n  dplyr::select(assessment, rater, acuracia) %>% \n  pivot_wider(names_from = assessment,\n              values_from = acuracia)\n```\n:::\n\n\n#### Testar as premissas\n\n#### Teste de normalidade\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(escala4$Unaided)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  escala4$Unaided\nW = 0.7748, p-value = 0.007155\n```\n\n\n:::\n\n```{.r .cell-code}\nshapiro.test(escala4$Aided1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  escala4$Aided1\nW = 0.92852, p-value = 0.4335\n```\n\n\n:::\n:::\n\n\nO teste mostra que não há normalidade para o tratamento \"unaided\" (valor de p \\< 0.05), logo será preciso realizar um **teste não paramétrico**.\\\n\n#### Teste de Wilcox\n\nComo o conjunto de dados não possui distribuição normal, será utilizado o teste de Wilcox (`wilcox.test`). Um teste não paramétrico para amostras dependentes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwilcox.test(escala4$Aided1,\n            escala4$Unaided,\n            paired = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon signed rank test with continuity correction\n\ndata:  escala4$Aided1 and escala4$Unaided\nV = 55, p-value = 0.005889\nalternative hypothesis: true location shift is not equal to 0\n```\n\n\n:::\n:::\n\n\nSimilarmente a situação de normalidade, o teste de Wilcox demonstra que há diferença significativa entre as amostras (P = 0.005 \\< ⍺ = 0.05), onde o uso da escala influencia positivamente a acurácia dos avaliadores.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}