{
  "hash": "6406a42a792ff4dfc5f8b4c211a16d15",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Aula 08 - Estatística inferencial - Experimento em DBC\"\nformat: html\neditor: visual\nexecute: \n  error: false\n  warning: false\neditor_options: \n  chunk_output_type: console\n---\n\n\nEsta aula aborda a análise de variância (ANOVA) de um experimento conduzido em delineamento com blocos ao acaso. Transformações de dados, como raiz quadrada e Box-Cox, são aplicadas quando necessário. Comparações de médias são feitas utilizando os pacotes emmeans e multcomp. Em seguida, é apresentado como construir uma curva de progresso da doença, calculando a área sob a curva (AUDPC) e realizando ANOVA para avaliar as diferenças entre tratamentos.\n\n## Carregando os pacotes\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gsheet)\nlibrary(tidyverse)\nlibrary(patchwork)\nlibrary(performance)\nlibrary(DHARMa)\nlibrary(emmeans)\nlibrary(multcomp)\nlibrary(multcompView)\nlibrary(MASS)\nlibrary(epifitter)\n```\n:::\n\n\n## Importando dados\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsoja <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=866852711\")\n```\n:::\n\n\n\\\nOs dados são referentes a um experimento de soja em campo, conduzido em blocos casualizados, onde o efeito de diferentes fungicidas (coluna \"TRAT\", 1 nível, 8 fatores) foi avaliado sobre as doenças de final de ciclo (DFC), a severidade da ferrugem (FER) e a produtividade (PROD).\\\n\\\nComo os dados da coluna TRAT e BLOCO são do tipo numérico, é preciso transformá-los para fator.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsoja$TRAT <- as.factor(soja$TRAT)\nsoja$BLOCO <- as.factor(soja$BLOCO)\n\n\n#ou#\n\n\nsoja <- soja %>% \n  mutate(TRAT = as.factor(TRAT),\n         BLOCO = as.factor(BLOCO))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(soja)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 32\nColumns: 5\n$ TRAT  <fct> 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 6, 6…\n$ BLOCO <fct> 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2…\n$ DFC   <dbl> 10.0, 10.5, 12.0, 11.0, 6.2, 6.0, 7.0, 6.5, 6.0, 6.2, 6.5, 5.5, …\n$ FER   <dbl> 17.0, 21.0, 25.0, 18.0, 6.5, 4.0, 8.0, 5.0, 6.0, 3.5, 2.5, 4.0, …\n$ PROD  <dbl> 4611, 4312, 4545, 3409, 5023, 4839, 4903, 4975, 5235, 5014, 5263…\n```\n\n\n:::\n:::\n\n\n## Estatística Descritiva - Visualização gráfica\n\nPara visualização dos dados das variáveis dependentes (DFC, FER e PROD), serão construídos gráficos de pontos (`ggplot`: `geom_jitter`) acrescido do intervalo de confiança.\\\nPara a apresentação do intervalo de confiança, será utilizada a função `stat_summary (fun.data)`, com o argumento `\"mean_cl_boot\"`.\n\n### DFC\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDFC <- soja %>% \n  ggplot(aes(TRAT, DFC))+\n  geom_jitter(width = 0.05)+\n  stat_summary (fun.data = \"mean_cl_boot\", color = \"darkred\", alpha = 0.5)\nDFC\n```\n\n::: {.cell-output-display}\n![](Aula-8.1_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n### FER\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFER <- soja %>% \n  ggplot(aes(TRAT, FER))+\n  geom_jitter(width = 0.05)+\n    stat_summary (fun.data = \"mean_cl_boot\", color = \"darkred\", alpha = 0.5)\nFER\n```\n\n::: {.cell-output-display}\n![](Aula-8.1_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n### PROD\n\n\n::: {.cell}\n\n```{.r .cell-code}\nPROD <- soja %>% \n  ggplot(aes(TRAT, PROD))+\n  geom_jitter(width = 0.05)+\n    stat_summary (fun.data = \"mean_cl_boot\", color = \"darkred\", alpha = 0.5)\nPROD\n```\n\n::: {.cell-output-display}\n![](Aula-8.1_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n### DFC+FER+PROD\n\nPara combinar os gráficos em uma única figura, utiliza-se o pacote **`patchwork`**:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(PROD + DFC / FER)\n```\n\n::: {.cell-output-display}\n![](Aula-8.1_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n## Estatística Inferencial\n\n## DFC\n\n### ANOVA\n\nPara realizar a análise de variância é preciso construir um modelo, nesse caso, um modelo linear (função `lm`), considerando TRAT e BLOCO como fatores fixos.\n\n\n::: {.cell}\n\n```{.r .cell-code}\naov_dfc <- lm (DFC ~ TRAT + BLOCO,\n               data = soja)\n\nanova(aov_dfc)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: DFC\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nTRAT       7 149.299 21.3284 51.5490 8.218e-12 ***\nBLOCO      3   0.461  0.1537  0.3716    0.7743    \nResiduals 21   8.689  0.4138                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\\\nPara o fator fixo, TRAT, há efeito significativo, logo há algum tratamento que difere dos demais. Para o fator BLOCO, não houve efeito, logo, não há diferença significativa entre eles.\\\n\n### Pressuposições da ANOVA\n\nA avaliação das pressuposições da ANOVA será realizada com as funções `check_normality` e `check_heteroscedasticity` (pacote **`Performance`**).\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_normality(aov_dfc)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: residuals appear as normally distributed (p = 0.978).\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(aov_dfc)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: Error variance appears to be homoscedastic (p = 0.532).\n```\n\n\n:::\n:::\n\n\nOs testes mostram que os resíduos são normalmente distribuídos e que há homogeneidade de variâncias entre os grupos. Assim, é possível proceder a comparação de médias.\n\n### Comparação de médias\n\nPara comparação de médias o modelo gerado acima será aplicado à função `emmeans` para criação de um novo objeto. Essa função estima uma média com base no modelo, logo algumas vezes pode não ser igual a média aritmética.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmedias_dfc <- emmeans(aov_dfc, ~TRAT)\nmedias_dfc\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n TRAT emmean    SE df lower.CL upper.CL\n 1     10.88 0.322 21    10.21    11.54\n 2      6.42 0.322 21     5.76     7.09\n 3      6.05 0.322 21     5.38     6.72\n 4      4.75 0.322 21     4.08     5.42\n 5      4.20 0.322 21     3.53     4.87\n 6      4.00 0.322 21     3.33     4.67\n 7      4.08 0.322 21     3.41     4.74\n 8      4.58 0.322 21     3.91     5.24\n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \n```\n\n\n:::\n:::\n\n\nEm seguida, o objeto criado será argumento das funções `pwpm` (**`emmeans`**) e `cld` (**`multcomp`**), que permitem visualização da comparação de médias.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npwpm (medias_dfc)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        1       2       3       4       5       6       7       8\n1 [10.87]  <.0001  <.0001  <.0001  <.0001  <.0001  <.0001  <.0001\n2   4.450 [ 6.42]  0.9896  0.0249  0.0017  0.0006  0.0009  0.0107\n3   4.825   0.375 [ 6.05]  0.1329  0.0107  0.0040  0.0058  0.0628\n4   6.125   1.675   1.300 [ 4.75]  0.9202  0.7173  0.8072  0.9999\n5   6.675   2.225   1.850   0.550 [ 4.20]  0.9998  1.0000  0.9896\n6   6.875   2.425   2.050   0.750   0.200 [ 4.00]  1.0000  0.9020\n7   6.800   2.350   1.975   0.675   0.125  -0.075 [ 4.07]  0.9499\n8   6.300   1.850   1.475   0.175  -0.375  -0.575  -0.500 [ 4.57]\n\nRow and column labels: TRAT\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n```\n\n\n:::\n:::\n\n\nNa função `pwpm`, há três informações úteis. Na diagonal, é apresentado o valor médio estimado para cada tratamento. Acima da diagonal, são plotados os valores de probabilidade, relacionados ao teste de Tukey, referentes às comparações múltiplas entre tratamentos. Abaixo da diagonal, há a diferença de valores médios entre os tratamentos.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncld (medias_dfc, Letters = LETTERS)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n TRAT emmean    SE df lower.CL upper.CL .group\n 6      4.00 0.322 21     3.33     4.67  A    \n 7      4.08 0.322 21     3.41     4.74  A    \n 5      4.20 0.322 21     3.53     4.87  A    \n 8      4.58 0.322 21     3.91     5.24  AB   \n 4      4.75 0.322 21     4.08     5.42  AB   \n 3      6.05 0.322 21     5.38     6.72   BC  \n 2      6.42 0.322 21     5.76     7.09    C  \n 1     10.88 0.322 21    10.21    11.54     D \n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 8 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n:::\n\n\nA função `cld` apresenta o resultado do teste de Tukey, com as letras representando os agrupamentos.\n\n## FER\n\n### ANOVA\n\nSimilar ao já feito para a variável DFC, será agora conduzido para a variável FER.\n\n\n::: {.cell}\n\n```{.r .cell-code}\naov_fer <- lm (FER ~ TRAT + BLOCO,\n               data = soja)  \nanova(aov_fer)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: FER\n          Df Sum Sq Mean Sq F value    Pr(>F)    \nTRAT       7 978.87 139.838 55.1717 4.218e-12 ***\nBLOCO      3   3.84   1.279  0.5045    0.6834    \nResiduals 21  53.23   2.535                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\nPara o fator fixo TRAT, há efeito significativo, logo há algum tratamento que difere dos demais. Para o fator BLOCO, não houve efeito já que não há diferença significativa entre eles.\n\n### Pressuposições da ANOVA\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_normality(aov_fer) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nWarning: Non-normality of residuals detected (p = 0.008).\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(aov_fer)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nWarning: Heteroscedasticity (non-constant error variance) detected (p < .001).\n```\n\n\n:::\n:::\n\n\nOs testes demonstram que os dados não satisfazem as pressuposições da ANOVA, logo será preciso adotar uma alternativa para análise dos dados, como por exemplo a transformação por raiz quadrada.\n\n### Transformação - Raiz quadrada\n\n\n::: {.cell}\n\n```{.r .cell-code}\naov_fer1 <- lm (sqrt(FER) ~ TRAT + BLOCO,\n               data = soja)  \nanova(aov_fer1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: sqrt(FER)\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nTRAT       7 24.5179  3.5026 56.4870 3.345e-12 ***\nBLOCO      3  0.1495  0.0498  0.8039    0.5057    \nResiduals 21  1.3021  0.0620                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\nPara os dados transformados pela raiz quadrada, o fator fixo TRAT continua possuindo efeito significativo, logo há algum tratamento que difere dos demais. Para o fator BLOCO, não houve efeito já que não há diferença significativa entre eles.\n\n#### Pressuposições da ANOVA\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_normality(aov_fer1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: residuals appear as normally distributed (p = 0.104).\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(aov_fer1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nWarning: Heteroscedasticity (non-constant error variance) detected (p < .001).\n```\n\n\n:::\n:::\n\n\nA transformação por raiz quadrada foi suficiente para normalizar os valores do resíduo, no entanto, ainda há heterocedasticidade. Assim, uma outra transformação será testada: transformação de Box-Cox.\n\n### Transformação - Box-Cox\n\n\n::: {.cell}\n\n```{.r .cell-code}\nb <- boxcox(lm(soja$FER ~ 1))\n```\n\n::: {.cell-output-display}\n![](Aula-8.1_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n\n```{.r .cell-code}\nlambda <- b$x [which.max(b$y)]\nlambda\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -1.555556\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsoja$FER2 <-(soja$FER ^ lambda - 1) / lambda\n```\n:::\n\n\n#### Novo modelo - Após transformação\n\n\n::: {.cell}\n\n```{.r .cell-code}\naov_fer2 <- lm (FER2 ~ TRAT + BLOCO,\n               data = soja)  \nanova(aov_fer2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: FER2\n          Df   Sum Sq   Mean Sq F value    Pr(>F)    \nTRAT       7 0.041641 0.0059488 12.9020 2.436e-06 ***\nBLOCO      3 0.005895 0.0019649  4.2616   0.01687 *  \nResiduals 21 0.009683 0.0004611                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\nPara os dados transformados por Box-Cox, o fator fixo TRAT continua possuindo efeito significativo, logo há algum tratamento que difere dos demais. Para o fator BLOCO, não houve efeito já que não há diferença significativa entre eles.\n\n#### Pressuposições da ANOVA\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_normality(aov_fer2) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: residuals appear as normally distributed (p = 0.787).\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(aov_fer2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: Error variance appears to be homoscedastic (p = 0.872).\n```\n\n\n:::\n:::\n\n\nOs testes demonstram que a transformação de Box-Cox foi suficiente para conferir normalidade aos resíduos e homogeneidade de variância entre os grupos.\n\n#### Comparação de médias\n\nCom os dados transformados por Box-Cox, será feita a comparação de médias como já descrito anteriormente.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmedias_fer2 <- emmeans(aov_fer2, ~TRAT) \nmedias_fer2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n TRAT emmean     SE df lower.CL upper.CL\n 1     0.637 0.0107 21    0.614    0.659\n 2     0.596 0.0107 21    0.574    0.618\n 3     0.553 0.0107 21    0.530    0.575\n 4     0.527 0.0107 21    0.505    0.550\n 5     0.539 0.0107 21    0.517    0.561\n 6     0.523 0.0107 21    0.501    0.545\n 7     0.545 0.0107 21    0.523    0.567\n 8     0.549 0.0107 21    0.527    0.572\n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npwpm (medias_fer2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         1        2        3        4        5        6        7       8\n1  [0.637]   0.1857   0.0004   <.0001   <.0001   <.0001   0.0001  0.0002\n2  0.04058  [0.596]   0.1358   0.0039   0.0208   0.0020   0.0497  0.0880\n3  0.08380  0.04322  [0.553]   0.7032   0.9807   0.5313   0.9995  1.0000\n4  0.10920  0.06862  0.02540  [0.527]   0.9938   1.0000   0.9339  0.8261\n5  0.09775  0.05717  0.01395 -0.01145  [0.539]   0.9629   0.9999  0.9964\n6  0.11349  0.07292  0.02970  0.00429  0.01575  [0.523]   0.8261  0.6703\n7  0.09154  0.05097  0.00775 -0.01766 -0.00620 -0.02195  [0.545]  1.0000\n8  0.08725  0.04667  0.00345 -0.02195 -0.01050 -0.02624 -0.00429 [0.549]\n\nRow and column labels: TRAT\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncld (medias_fer2, Letters = LETTERS)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n TRAT emmean     SE df lower.CL upper.CL .group\n 6     0.523 0.0107 21    0.501    0.545  A    \n 4     0.527 0.0107 21    0.505    0.550  A    \n 5     0.539 0.0107 21    0.517    0.561  A    \n 7     0.545 0.0107 21    0.523    0.567  A    \n 8     0.549 0.0107 21    0.527    0.572  AB   \n 3     0.553 0.0107 21    0.530    0.575  AB   \n 2     0.596 0.0107 21    0.574    0.618   BC  \n 1     0.637 0.0107 21    0.614    0.659    C  \n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 8 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n:::\n\n\nPelo fato de ter sido utilizada a transformação de Box-Cox, os valores apresentados no resultado acima são da transformação e para apresentação em uma tabela seria preciso obter os originais.\n\n## PROD\n\n### ANOVA\n\nSimilar ao já feito para a variável DFC, será agora conduzido para a variável PROD.\n\n\n::: {.cell}\n\n```{.r .cell-code}\naov_prod <- lm(PROD ~ TRAT + BLOCO,\n               data = soja)\nanova(aov_prod)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: PROD\n          Df  Sum Sq Mean Sq F value  Pr(>F)  \nTRAT       7 2993906  427701  2.6367 0.04021 *\nBLOCO      3  105665   35222  0.2171 0.88340  \nResiduals 21 3406431  162211                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\\\nPara o fator fixo TRAT, há efeito significativo, logo há algum tratamento que difere dos demais. Para o fator BLOCO, não houve efeito já que não há diferença significativa entre eles.\\\n\n### Pressuposições da ANOVA\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_normality(aov_prod)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: residuals appear as normally distributed (p = 0.542).\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(aov_prod)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: Error variance appears to be homoscedastic (p = 0.215).\n```\n\n\n:::\n:::\n\n\nOs testes mostram que os resíduos são normalmente distribuídos e que há homogeneidade de variâncias entre os grupos. Assim, é possível proceder a comparação de médias.\n\n### Comparação de médias\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmedias_prod <- emmeans(aov_prod, ~ TRAT)\nmedias_prod\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n TRAT emmean  SE df lower.CL upper.CL\n 1      4219 201 21     3800     4638\n 2      4935 201 21     4516     5354\n 3      5110 201 21     4691     5529\n 4      5140 201 21     4721     5559\n 5      5122 201 21     4703     5541\n 6      5256 201 21     4837     5675\n 7      5128 201 21     4709     5546\n 8      5078 201 21     4659     5497\n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_prod_grupo <- cld (medias_prod, Letters = LETTERS)\ndf_prod_grupo\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n TRAT emmean  SE df lower.CL upper.CL .group\n 1      4219 201 21     3800     4638  A    \n 2      4935 201 21     4516     5354  AB   \n 8      5078 201 21     4659     5497  AB   \n 3      5110 201 21     4691     5529  AB   \n 5      5122 201 21     4703     5541  AB   \n 7      5128 201 21     4709     5546  AB   \n 4      5140 201 21     4721     5559  AB   \n 6      5256 201 21     4837     5675   B   \n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 8 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n:::\n\n\nGráfico com médias e intervalo de confiança, uma maneira visual de apresentar os resultados.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_prod <- data.frame(medias_prod)\ndf_prod %>% \n  ggplot(aes(TRAT, emmean))+\n  geom_point()+\n  ylim (3000, 6600)+\n  geom_errorbar(aes(min = lower.CL,\n                    max = upper.CL),\n                    width = 0.1)+\n  annotate(geom = \"text\", \n           x = 1.2, \n           y = 4200, \n           label = \"A\")+\n  annotate(geom = \"text\", \n           x = 2.2, \n           y = 4950, \n           label = \"AB\")+\n  annotate(geom = \"text\", \n           x = 3.2, \n           y = 5100, \n           label = \"AB\")\n```\n\n::: {.cell-output-display}\n![](Aula-8.1_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\nA anotação das letras, deve ser feita manualmente com a função `annotate`.\\\n\n### Exportando os dados\n\nTambém é possível exportar a tabela de comparação de médias com a função `write_xlsx` (**`writexl`**).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::kable(df_prod_grupo %>% \n               dplyr::select(TRAT, emmean, .group))\n```\n\n::: {.cell-output-display}\n\n\n|   |TRAT |  emmean|.group |\n|:--|:----|-------:|:------|\n|1  |1    | 4219.25|A      |\n|2  |2    | 4935.00|AB     |\n|8  |8    | 5078.25|AB     |\n|3  |3    | 5110.00|AB     |\n|5  |5    | 5122.00|AB     |\n|7  |7    | 5127.50|AB     |\n|4  |4    | 5140.25|AB     |\n|6  |6    | 5256.25|B      |\n\n\n:::\n\n```{.r .cell-code}\nlibrary(writexl)\nwrite_xlsx(df_prod, \"df.xlsx\")\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}