[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "FIP 606 | por Caio M.",
    "section": "",
    "text": "Este é um site baseado em Quarto. Ele foi criado para armazenar e compartilhar as informações geradas ao longo das aulas da disciplina FIP 606 - Análise e Visualização de Dados em Fitopatologia, oferecida pelo prof. Emerson Del Ponte e cursada durante o primeiro semestre de 2024.",
    "crumbs": [
      "Home",
      "Basics",
      "FIP 606 | por Caio M."
    ]
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "Site criado para hospedar os dados gerados ao longo da disciplina FIP 606 - Análise e Visualização de Dados em Fitopatologia."
  },
  {
    "objectID": "Aula 10.html",
    "href": "Aula 10.html",
    "title": "Aula 10",
    "section": "",
    "text": "library(gsheet)\nlibrary(tidyverse)\nlibrary(patchwork)\nlibrary(AgroR)\n\n\n\n\ncorr &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=373270992\")\n\n\n\n\n\nConsiderando o software “Assess” como o padrão, serão feitos gráficos de correlação entre ele e os outros softwares, “LeafDoctor” e “ImageJ”. O objetivo é verificar se os métodos possuem alguma correlação com o “Assess” e se essa correlação é positiva ou negativa.\n\ng1 &lt;- corr %&gt;% \n  ggplot(aes(Assess, LeafDoctor))+\n  geom_point()+\n  geom_smooth(method = \"lm\")\n\ng1\n\n\n\n\n\n\n\n\n\ng2 &lt;- corr %&gt;% \n  ggplot(aes(Assess, ImageJ))+\n  geom_point()+\n  geom_smooth(method = \"lm\")\n\ng2\n\n\n\n\n\n\n\n\nOs gráficos acima demonstram que os softwares avaliados possuem correlação positiva com o software “Assess”.\n\n\n\nSerá construído um boxplot para verificar a variabilidade dos dados em função do método (software).\n\ng3 &lt;- corr %&gt;%\n  pivot_longer(3:5, names_to = \"method\",\n               values_to = \"value\") %&gt;% \n  ggplot(aes(method , value))+\n  geom_boxplot()\n\ng3\n\n\n\n\n\n\n\n\nCom o pacote patchwork será feito um plot contendo os três gráficos gerados anteriormente:\n\ng3 + (g1/g2)\n\n\n\n\n\n\n\n\n\n\n\n\nO coeficiente de correlação (ou correlação de Pearson) varia entre -1 e +1. Se o valor for negativo, há correlação negativa; caso seja positivo, a correlação será positiva. Além disso, quanto mais próximo às extremidades (-1 ou +1), mais forte será a correlação.\nUma opção para obter os coeficientes de correlação (r) é adotar a função cor.test (nativa do R):\n\ncor.test(corr$Assess, corr$LeafDoctor)\n\n\n    Pearson's product-moment correlation\n\ndata:  corr$Assess and corr$LeafDoctor\nt = 31.119, df = 68, p-value &lt; 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.9466882 0.9792005\nsample estimates:\n      cor \n0.9666367 \n\n\n\ncor.test(corr$Assess, corr$ImageJ)\n\n\n    Pearson's product-moment correlation\n\ndata:  corr$Assess and corr$ImageJ\nt = 38.383, df = 68, p-value &lt; 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.9642331 0.9861219\nsample estimates:\n      cor \n0.9776918 \n\n\nPelo coeficientes obtidos, é possível dizer que os softwares possuem correlação positiva e forte, pois os valores\n\n\nCom AgroR:\nAntes é preciso criar um objeto com os coeficientes de correlação.\n\ncorr %&gt;% \n  select(3:5) %&gt;%\n  corgraph()\n\n        Var1       Var2       cor            p\n2 LeafDoctor     Assess 0.9666367 5.972544e-42\n3     ImageJ     Assess 0.9776918 8.143613e-48\n6     ImageJ LeafDoctor 0.9797478 3.144091e-49\n\n\n\n\n\n\n\n\n#ou#\n\n\ncorr2 &lt;- corr %&gt;%\n  select(3:5)\n\ncorgraph(corr2)\n\n        Var1       Var2       cor            p\n2 LeafDoctor     Assess 0.9666367 5.972544e-42\n3     ImageJ     Assess 0.9776918 8.143613e-48\n6     ImageJ LeafDoctor 0.9797478 3.144091e-49\n\n\n\n\n\n\n\n\n\nCom corrplot:\n\nlibrary(corrplot)\n\ncorr2_1 &lt;- cor(corr2)\ncorrplot(corr2_1, method = \"square\", type = \"upper\")\n\n\n\n\n\n\n\n\nAlterando alguns parâmetros na função (conferir o help, pois há outras variações possíveis):\n\nO argumento diag = FALSE remove a comparação dentro de um mesmo método, por exemplo, Assess com Assess.\n\n\ncorrplot(corr2_1, method = \"number\", type = \"upper\", diag = FALSE)\n\n\n\n\n\n\n\n\n\n\n\n\nUm outro exemplo de correlação, com o conjunto de dados de aulas passadas.\n\ncampo &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=866852711\")\n\ncampo2 &lt;- campo |&gt; \n  dplyr::select(DFC, FER, PROD)\n\nCom corgraph\n\ncorgraph(campo2)\n\n  Var1 Var2        cor            p\n2  FER  DFC  0.9316978 9.864101e-15\n3 PROD  DFC -0.6928161 1.110652e-05\n6 PROD  FER -0.6258321 1.277444e-04\n\n\n\n\n\n\n\n\n\nCom corrplot\n\ncampo2_1 &lt;- cor(campo2)\ncampo2_1 %&gt;% corrplot(method = \"number\", type = \"lower\", diag = FALSE)\n\n\n\n\n\n\n\n\n\n\n\ncor.test(campo2$PROD, campo2$DFC)\n\n\n    Pearson's product-moment correlation\n\ndata:  campo2$PROD and campo2$DFC\nt = -5.2623, df = 30, p-value = 1.111e-05\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.8388581 -0.4537361\nsample estimates:\n       cor \n-0.6928161 \n\ncor.test(campo2$PROD, campo2$FER)\n\n\n    Pearson's product-moment correlation\n\ndata:  campo2$PROD and campo2$FER\nt = -4.3949, df = 30, p-value = 0.0001277\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.7999565 -0.3544981\nsample estimates:\n       cor \n-0.6258321 \n\n\nAvalia-se os intervalos de confiança obtidos (IC da correlação entre PROD e DFC vs. IC da correlação entre PROD e FER) e caso não haja sobreposição de intervalos, as correlações diferem estatisticamente.\n____\n\n\n\n\n\n\nestande &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=401662555\")\n\nNa aula anterior, foi visto que o ensaio 2 não apresentava uma tendência linear.\nEsse ensaio será utilizado para exemplificar uma regressão linear de segunda ordem.\n\nexp2 &lt;- estande %&gt;% \n  filter(exp == 2)\n\n\nexp2 %&gt;% \n  ggplot(aes(trat, nplants))+\n  geom_point()+\n  ylim(0,100)+\n  geom_smooth(method = \"lm\",\n              se = F,\n              color = \"green\",\n              formula = y ~ poly(x,2))+\n  geom_smooth(method = \"lm\",\n              se = F,\n              color = \"red\")\n\n\n\n\n\n\n\n\nEm vermelho, a linha que indica o modelo linear de primeira ordem. Em verde, o modelo linear de segunda ordem.\n\n\n\nlm2 &lt;- lm(nplants ~ trat,\n          data = exp2)\n\nsummary(lm2)\n\n\nCall:\nlm(formula = nplants ~ trat, data = exp2)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-25.7816  -7.7150   0.5653   8.1929  19.2184 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  60.9857     3.6304  16.798 4.93e-14 ***\ntrat         -0.7007     0.1605  -4.365 0.000247 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.95 on 22 degrees of freedom\nMultiple R-squared:  0.4641,    Adjusted R-squared:  0.4398 \nF-statistic: 19.05 on 1 and 22 DF,  p-value: 0.0002473\n\n\nComo o resultado demonstra, para o modelo linear, o coeficiente de determinação é baixo (R2 = 0.43) , logo boa parte da variação dos dados não são explicados por esse modelo.\n\n\n\nPara construir o modelo quadrático é preciso acrescentar uma coluna ao conjunto de dados, onde a varíavel independente (nesse caso, trat) será elevada ao quadrado. Isso é necessário para obtermos um segundo coeficiente no momento de criar o modelo.\n\nexp2$trat2 &lt;- exp2$trat^2\n\n\nlm2_quad &lt;- lm(nplants ~ trat + trat2,\n               data = exp2)\nsummary(lm2_quad)\n\n\nCall:\nlm(formula = nplants ~ trat + trat2, data = exp2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-25.439  -6.019   1.789   8.016  19.561 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 66.30156    4.42097  14.997 1.08e-12 ***\ntrat        -1.77720    0.58467  -3.040  0.00623 ** \ntrat2        0.02223    0.01166   1.906  0.07036 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.24 on 21 degrees of freedom\nMultiple R-squared:  0.5432,    Adjusted R-squared:  0.4997 \nF-statistic: 12.49 on 2 and 21 DF,  p-value: 0.0002675\n\n\nCom a função polynomial (AgroR):\n\nwith(exp2, polynomial(trat, nplants, grau = 2))\n\n\n----------------------------------------------------\nRegression Models\n----------------------------------------------------\n               Estimate Std. Error   t value     Pr(&gt;|t|)\n(Intercept) 66.30156250 4.42096799 14.997069 1.079972e-12\ntrat        -1.77719814 0.58467380 -3.039640 6.230050e-03\nI(trat^2)    0.02222876 0.01165948  1.906496 7.036247e-02\n\n----------------------------------------------------\nDeviations from regression\n----------------------------------------------------\n          Df       SSq       MSQ         F      p-value\nLinear     1 3196.2031 3196.2031 21.823293 0.0001899378\nQuadratic  1  544.5029  544.5029  3.717801 0.0697619482\nDeviation  3  509.6690  169.8897  1.159986 0.3523240106\nResidual  18 2636.2500  146.4583                       \n\n\n[[1]]\n\n\n\n\n\n\n\n\n\n\n\n\n\nAIC(lm2)\n\n[1] 194.9597\n\nAIC(lm2_quad)\n\n[1] 193.1284\n\n\nPelo teste de AIC, em comparação ao modelo linear, o modelo quadrático explica melhor a variação dos dados, pois AIC(lm2_quad) &lt; AIC(lm2).\n\n\n\nwith(exp2, polynomial(trat, nplants, grau = 3))\n\n\n----------------------------------------------------\nRegression Models\n----------------------------------------------------\n                Estimate  Std. Error   t value     Pr(&gt;|t|)\n(Intercept) 70.265143802 5.300440019 13.256474 2.295186e-11\ntrat        -3.609380523 1.514625525 -2.383018 2.720299e-02\nI(trat^2)    0.140522077 0.091192577  1.540938 1.390058e-01\nI(trat^3)   -0.001712445 0.001309648 -1.307561 2.058546e-01\n\n----------------------------------------------------\nDeviations from regression\n----------------------------------------------------\n          Df       SSq       MSQ          F      p-value\nLinear     1 3196.2031 3196.2031 21.8232929 0.0001899378\nQuadratic  1  544.5029  544.5029  3.7178008 0.0697619482\nCubic      1  247.7520  247.7520  1.6916208 0.2097934169\nDeviation  2  261.9170  130.9585  0.8941691 0.4263523326\nResidual  18 2636.2500  146.4583                        \n\n\n[[1]]\n\n\n\n\n\n\n\n\n\nApesar do polinômio de grau 3 explicar melhor os dados, o modelo não possui explicação biológica plausível (do estande de plantas aumentar em função do aumento do inóculo para depois decrescer).\n\n\n\n\n\nAplicação na fitopatologia, em curvas de EC50.\n\nfung &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=465348652\")\n\nCálculo da média de germinação em função do isolado.\n\nfung2 &lt;- fung %&gt;% \n  group_by(code, dose) %&gt;% \n  summarise(mean_germ = mean(germination))\n\n\nVisualização da média de germinação com gráfico de pontos\n\nfung2 %&gt;% \n  ggplot(aes(dose, mean_germ))+\n  geom_point()+\n  facet_wrap(~ code)\n\n\n\n\n\n\n\n\n\n\nPara modelar a EC50 será utilizado o pacote drc, com a função drm.\nAntes, é preciso criar um novo objeto somente com os dados do isolado selecionado (ex.: FGT05). Em seguida, definimos na função drm que a germinação média será modela em função da dose, qual o conjunto de dados (data = FGT05) e qual a função utilizada (no caso, fct = LL.3()).\n\nlibrary(drc)\n\nFGT05 &lt;- fung2 %&gt;% \n  filter(code ==\"FGT05\")\n\ndrc_fgt05 &lt;- drm(mean_germ ~ dose,\n                 data = FGT05,\n                 fct = LL.3())\n\nsummary(drc_fgt05)\n\n\nModel fitted: Log-logistic (ED50 as parameter) with lower limit at 0 (3 parms)\n\nParameter estimates:\n\n               Estimate Std. Error t-value   p-value    \nb:(Intercept)  0.769933   0.198566  3.8775 0.0303750 *  \nd:(Intercept) 44.924753   3.261699 13.7734 0.0008283 ***\ne:(Intercept)  0.044839   0.019291  2.3243 0.1026764    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error:\n\n 3.253867 (3 degrees of freedom)\n\nAIC(drc_fgt05)\n\n[1] 35.02651\n\nplot(drc_fgt05)\n\n\n\n\n\n\n\n\nÉ importante definir a função para comparar os modelos e selecionar aquele mais simples (com menor AIC).\n\n\n\nSerá utilizada a função ED pacote (drc).\nSeleciona-se o objeto, o valor da varíavel resposta (50), e o tipo de intervalo de confiança que será apresentado.\n\nED(drc_fgt05, 50, interval = \"delta\")\n\n\nEstimated effective doses\n\n        Estimate Std. Error     Lower     Upper\ne:1:50  0.044839   0.019291 -0.016554  0.106231\n\n\nNo caso, a dose que inibe 50% da germinação de conídios foi estimada em 0.04, com -0.01 &lt; IC &lt; 0.10.\n\n\n\nI_165 &lt;- fung2 %&gt;% \n  filter(code ==\"165\")\n\ndrc_165 &lt;- drm(mean_germ ~ dose,\n                 data = I_165,\n                 fct = LL.3())\n\nsummary(drc_165)\n\n\nModel fitted: Log-logistic (ED50 as parameter) with lower limit at 0 (3 parms)\n\nParameter estimates:\n\n              Estimate Std. Error t-value   p-value    \nb:(Intercept)  1.21560    0.26679  4.5564 0.0198145 *  \nd:(Intercept) 36.14322    1.97554 18.2954 0.0003563 ***\ne:(Intercept)  0.55840    0.11420  4.8898 0.0163598 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error:\n\n 2.436519 (3 degrees of freedom)\n\nAIC(drc_165)\n\n[1] 31.55522\n\nplot(drc_165)\n\n\n\n\n\n\n\nED(drc_165,50, interval = \"delta\")\n\n\nEstimated effective doses\n\n       Estimate Std. Error   Lower   Upper\ne:1:50  0.55840    0.11420 0.19498 0.92182\n\n\n\nI_186 &lt;- fung2 %&gt;% \n  filter(code ==\"186\")\n\ndrc_186 &lt;- drm(mean_germ ~ dose,\n                 data = I_186,\n                 fct = LL.3())\n\nsummary(drc_186)\n\n\nModel fitted: Log-logistic (ED50 as parameter) with lower limit at 0 (3 parms)\n\nParameter estimates:\n\n               Estimate Std. Error t-value   p-value    \nb:(Intercept)  4.997636   0.542650  9.2097  0.002708 ** \nd:(Intercept) 48.750109   0.721642 67.5545 7.148e-06 ***\ne:(Intercept)  0.579757   0.013332 43.4853 2.677e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error:\n\n 1.020525 (3 degrees of freedom)\n\nAIC(drc_186)\n\n[1] 21.11219\n\nplot(drc_186)\n\n\n\n\n\n\n\nED(drc_186, 50, interval = \"delta\")\n\n\nEstimated effective doses\n\n       Estimate Std. Error    Lower    Upper\ne:1:50 0.579757   0.013332 0.537328 0.622187\n\n\n\n\n\n\nPelo método anterior, é preciso modelar o EC50 individualmente, o que pode ser trabalhoso, dependendo do número de amostras. Assim, o pacote ec50estimator é útil nessa situações, pois permite modelar, calcular a EC50 e o IC de todos os tratamento de uma só vez.\n\nlibrary(ec50estimator)\n\ndf_ec50 &lt;- estimate_EC50(mean_germ~dose,\n                         data = fung2,\n                         isolate_col = \"code\",\n                         interval = \"delta\",\n                         fct = drc::LL.3())\nview(df_ec50)\n\nlibrary(DT)\ndatatable(df_ec50)\n\n\n\n\n\nProblema, não é possível selecionar a função de cada modelo para melhor se adequar a cada tratamento.\nGráfico com as doses de EC50 e intervalo de confiança:\n\ndf_ec50 %&gt;% \n  ggplot(aes(reorder(ID, Estimate), Estimate))+\n  geom_point()+\n  geom_errorbar(aes(ymin = Lower,\n                    ymax = Upper),\n                width = 0.1)+\n  ylim (0, 1.2)+\n  coord_flip()\n\n\n\n\n\n\n\n\nArgumento reorder(ID, Estimate), Estimate , utilizado para ordenar os tratamentos em função da resposta (ordem crescente).",
    "crumbs": [
      "Home",
      "Análises",
      "Aula 10"
    ]
  },
  {
    "objectID": "Aula 10.html#análise-de-correlação",
    "href": "Aula 10.html#análise-de-correlação",
    "title": "Aula 10",
    "section": "",
    "text": "corr &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=373270992\")\n\n\n\n\n\nConsiderando o software “Assess” como o padrão, serão feitos gráficos de correlação entre ele e os outros softwares, “LeafDoctor” e “ImageJ”. O objetivo é verificar se os métodos possuem alguma correlação com o “Assess” e se essa correlação é positiva ou negativa.\n\ng1 &lt;- corr %&gt;% \n  ggplot(aes(Assess, LeafDoctor))+\n  geom_point()+\n  geom_smooth(method = \"lm\")\n\ng1\n\n\n\n\n\n\n\n\n\ng2 &lt;- corr %&gt;% \n  ggplot(aes(Assess, ImageJ))+\n  geom_point()+\n  geom_smooth(method = \"lm\")\n\ng2\n\n\n\n\n\n\n\n\nOs gráficos acima demonstram que os softwares avaliados possuem correlação positiva com o software “Assess”.\n\n\n\nSerá construído um boxplot para verificar a variabilidade dos dados em função do método (software).\n\ng3 &lt;- corr %&gt;%\n  pivot_longer(3:5, names_to = \"method\",\n               values_to = \"value\") %&gt;% \n  ggplot(aes(method , value))+\n  geom_boxplot()\n\ng3\n\n\n\n\n\n\n\n\nCom o pacote patchwork será feito um plot contendo os três gráficos gerados anteriormente:\n\ng3 + (g1/g2)\n\n\n\n\n\n\n\n\n\n\n\n\nO coeficiente de correlação (ou correlação de Pearson) varia entre -1 e +1. Se o valor for negativo, há correlação negativa; caso seja positivo, a correlação será positiva. Além disso, quanto mais próximo às extremidades (-1 ou +1), mais forte será a correlação.\nUma opção para obter os coeficientes de correlação (r) é adotar a função cor.test (nativa do R):\n\ncor.test(corr$Assess, corr$LeafDoctor)\n\n\n    Pearson's product-moment correlation\n\ndata:  corr$Assess and corr$LeafDoctor\nt = 31.119, df = 68, p-value &lt; 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.9466882 0.9792005\nsample estimates:\n      cor \n0.9666367 \n\n\n\ncor.test(corr$Assess, corr$ImageJ)\n\n\n    Pearson's product-moment correlation\n\ndata:  corr$Assess and corr$ImageJ\nt = 38.383, df = 68, p-value &lt; 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.9642331 0.9861219\nsample estimates:\n      cor \n0.9776918 \n\n\nPelo coeficientes obtidos, é possível dizer que os softwares possuem correlação positiva e forte, pois os valores\n\n\nCom AgroR:\nAntes é preciso criar um objeto com os coeficientes de correlação.\n\ncorr %&gt;% \n  select(3:5) %&gt;%\n  corgraph()\n\n        Var1       Var2       cor            p\n2 LeafDoctor     Assess 0.9666367 5.972544e-42\n3     ImageJ     Assess 0.9776918 8.143613e-48\n6     ImageJ LeafDoctor 0.9797478 3.144091e-49\n\n\n\n\n\n\n\n\n#ou#\n\n\ncorr2 &lt;- corr %&gt;%\n  select(3:5)\n\ncorgraph(corr2)\n\n        Var1       Var2       cor            p\n2 LeafDoctor     Assess 0.9666367 5.972544e-42\n3     ImageJ     Assess 0.9776918 8.143613e-48\n6     ImageJ LeafDoctor 0.9797478 3.144091e-49\n\n\n\n\n\n\n\n\n\nCom corrplot:\n\nlibrary(corrplot)\n\ncorr2_1 &lt;- cor(corr2)\ncorrplot(corr2_1, method = \"square\", type = \"upper\")\n\n\n\n\n\n\n\n\nAlterando alguns parâmetros na função (conferir o help, pois há outras variações possíveis):\n\nO argumento diag = FALSE remove a comparação dentro de um mesmo método, por exemplo, Assess com Assess.\n\n\ncorrplot(corr2_1, method = \"number\", type = \"upper\", diag = FALSE)\n\n\n\n\n\n\n\n\n\n\n\n\nUm outro exemplo de correlação, com o conjunto de dados de aulas passadas.\n\ncampo &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=866852711\")\n\ncampo2 &lt;- campo |&gt; \n  dplyr::select(DFC, FER, PROD)\n\nCom corgraph\n\ncorgraph(campo2)\n\n  Var1 Var2        cor            p\n2  FER  DFC  0.9316978 9.864101e-15\n3 PROD  DFC -0.6928161 1.110652e-05\n6 PROD  FER -0.6258321 1.277444e-04\n\n\n\n\n\n\n\n\n\nCom corrplot\n\ncampo2_1 &lt;- cor(campo2)\ncampo2_1 %&gt;% corrplot(method = \"number\", type = \"lower\", diag = FALSE)\n\n\n\n\n\n\n\n\n\n\n\ncor.test(campo2$PROD, campo2$DFC)\n\n\n    Pearson's product-moment correlation\n\ndata:  campo2$PROD and campo2$DFC\nt = -5.2623, df = 30, p-value = 1.111e-05\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.8388581 -0.4537361\nsample estimates:\n       cor \n-0.6928161 \n\ncor.test(campo2$PROD, campo2$FER)\n\n\n    Pearson's product-moment correlation\n\ndata:  campo2$PROD and campo2$FER\nt = -4.3949, df = 30, p-value = 0.0001277\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.7999565 -0.3544981\nsample estimates:\n       cor \n-0.6258321 \n\n\nAvalia-se os intervalos de confiança obtidos (IC da correlação entre PROD e DFC vs. IC da correlação entre PROD e FER) e caso não haja sobreposição de intervalos, as correlações diferem estatisticamente.\n____",
    "crumbs": [
      "Home",
      "Análises",
      "Aula 10"
    ]
  },
  {
    "objectID": "Aula 10.html#regressão-linear-de-segunda-ordem-quadrática",
    "href": "Aula 10.html#regressão-linear-de-segunda-ordem-quadrática",
    "title": "Aula 10",
    "section": "",
    "text": "estande &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=401662555\")\n\nNa aula anterior, foi visto que o ensaio 2 não apresentava uma tendência linear.\nEsse ensaio será utilizado para exemplificar uma regressão linear de segunda ordem.\n\nexp2 &lt;- estande %&gt;% \n  filter(exp == 2)\n\n\nexp2 %&gt;% \n  ggplot(aes(trat, nplants))+\n  geom_point()+\n  ylim(0,100)+\n  geom_smooth(method = \"lm\",\n              se = F,\n              color = \"green\",\n              formula = y ~ poly(x,2))+\n  geom_smooth(method = \"lm\",\n              se = F,\n              color = \"red\")\n\n\n\n\n\n\n\n\nEm vermelho, a linha que indica o modelo linear de primeira ordem. Em verde, o modelo linear de segunda ordem.\n\n\n\nlm2 &lt;- lm(nplants ~ trat,\n          data = exp2)\n\nsummary(lm2)\n\n\nCall:\nlm(formula = nplants ~ trat, data = exp2)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-25.7816  -7.7150   0.5653   8.1929  19.2184 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  60.9857     3.6304  16.798 4.93e-14 ***\ntrat         -0.7007     0.1605  -4.365 0.000247 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.95 on 22 degrees of freedom\nMultiple R-squared:  0.4641,    Adjusted R-squared:  0.4398 \nF-statistic: 19.05 on 1 and 22 DF,  p-value: 0.0002473\n\n\nComo o resultado demonstra, para o modelo linear, o coeficiente de determinação é baixo (R2 = 0.43) , logo boa parte da variação dos dados não são explicados por esse modelo.\n\n\n\nPara construir o modelo quadrático é preciso acrescentar uma coluna ao conjunto de dados, onde a varíavel independente (nesse caso, trat) será elevada ao quadrado. Isso é necessário para obtermos um segundo coeficiente no momento de criar o modelo.\n\nexp2$trat2 &lt;- exp2$trat^2\n\n\nlm2_quad &lt;- lm(nplants ~ trat + trat2,\n               data = exp2)\nsummary(lm2_quad)\n\n\nCall:\nlm(formula = nplants ~ trat + trat2, data = exp2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-25.439  -6.019   1.789   8.016  19.561 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 66.30156    4.42097  14.997 1.08e-12 ***\ntrat        -1.77720    0.58467  -3.040  0.00623 ** \ntrat2        0.02223    0.01166   1.906  0.07036 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.24 on 21 degrees of freedom\nMultiple R-squared:  0.5432,    Adjusted R-squared:  0.4997 \nF-statistic: 12.49 on 2 and 21 DF,  p-value: 0.0002675\n\n\nCom a função polynomial (AgroR):\n\nwith(exp2, polynomial(trat, nplants, grau = 2))\n\n\n----------------------------------------------------\nRegression Models\n----------------------------------------------------\n               Estimate Std. Error   t value     Pr(&gt;|t|)\n(Intercept) 66.30156250 4.42096799 14.997069 1.079972e-12\ntrat        -1.77719814 0.58467380 -3.039640 6.230050e-03\nI(trat^2)    0.02222876 0.01165948  1.906496 7.036247e-02\n\n----------------------------------------------------\nDeviations from regression\n----------------------------------------------------\n          Df       SSq       MSQ         F      p-value\nLinear     1 3196.2031 3196.2031 21.823293 0.0001899378\nQuadratic  1  544.5029  544.5029  3.717801 0.0697619482\nDeviation  3  509.6690  169.8897  1.159986 0.3523240106\nResidual  18 2636.2500  146.4583                       \n\n\n[[1]]\n\n\n\n\n\n\n\n\n\n\n\n\n\nAIC(lm2)\n\n[1] 194.9597\n\nAIC(lm2_quad)\n\n[1] 193.1284\n\n\nPelo teste de AIC, em comparação ao modelo linear, o modelo quadrático explica melhor a variação dos dados, pois AIC(lm2_quad) &lt; AIC(lm2).\n\n\n\nwith(exp2, polynomial(trat, nplants, grau = 3))\n\n\n----------------------------------------------------\nRegression Models\n----------------------------------------------------\n                Estimate  Std. Error   t value     Pr(&gt;|t|)\n(Intercept) 70.265143802 5.300440019 13.256474 2.295186e-11\ntrat        -3.609380523 1.514625525 -2.383018 2.720299e-02\nI(trat^2)    0.140522077 0.091192577  1.540938 1.390058e-01\nI(trat^3)   -0.001712445 0.001309648 -1.307561 2.058546e-01\n\n----------------------------------------------------\nDeviations from regression\n----------------------------------------------------\n          Df       SSq       MSQ          F      p-value\nLinear     1 3196.2031 3196.2031 21.8232929 0.0001899378\nQuadratic  1  544.5029  544.5029  3.7178008 0.0697619482\nCubic      1  247.7520  247.7520  1.6916208 0.2097934169\nDeviation  2  261.9170  130.9585  0.8941691 0.4263523326\nResidual  18 2636.2500  146.4583                        \n\n\n[[1]]\n\n\n\n\n\n\n\n\n\nApesar do polinômio de grau 3 explicar melhor os dados, o modelo não possui explicação biológica plausível (do estande de plantas aumentar em função do aumento do inóculo para depois decrescer).",
    "crumbs": [
      "Home",
      "Análises",
      "Aula 10"
    ]
  },
  {
    "objectID": "Aula 10.html#modelo-nãolinear",
    "href": "Aula 10.html#modelo-nãolinear",
    "title": "Aula 10",
    "section": "",
    "text": "Aplicação na fitopatologia, em curvas de EC50.\n\nfung &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=465348652\")\n\nCálculo da média de germinação em função do isolado.\n\nfung2 &lt;- fung %&gt;% \n  group_by(code, dose) %&gt;% \n  summarise(mean_germ = mean(germination))\n\n\nVisualização da média de germinação com gráfico de pontos\n\nfung2 %&gt;% \n  ggplot(aes(dose, mean_germ))+\n  geom_point()+\n  facet_wrap(~ code)\n\n\n\n\n\n\n\n\n\n\nPara modelar a EC50 será utilizado o pacote drc, com a função drm.\nAntes, é preciso criar um novo objeto somente com os dados do isolado selecionado (ex.: FGT05). Em seguida, definimos na função drm que a germinação média será modela em função da dose, qual o conjunto de dados (data = FGT05) e qual a função utilizada (no caso, fct = LL.3()).\n\nlibrary(drc)\n\nFGT05 &lt;- fung2 %&gt;% \n  filter(code ==\"FGT05\")\n\ndrc_fgt05 &lt;- drm(mean_germ ~ dose,\n                 data = FGT05,\n                 fct = LL.3())\n\nsummary(drc_fgt05)\n\n\nModel fitted: Log-logistic (ED50 as parameter) with lower limit at 0 (3 parms)\n\nParameter estimates:\n\n               Estimate Std. Error t-value   p-value    \nb:(Intercept)  0.769933   0.198566  3.8775 0.0303750 *  \nd:(Intercept) 44.924753   3.261699 13.7734 0.0008283 ***\ne:(Intercept)  0.044839   0.019291  2.3243 0.1026764    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error:\n\n 3.253867 (3 degrees of freedom)\n\nAIC(drc_fgt05)\n\n[1] 35.02651\n\nplot(drc_fgt05)\n\n\n\n\n\n\n\n\nÉ importante definir a função para comparar os modelos e selecionar aquele mais simples (com menor AIC).\n\n\n\nSerá utilizada a função ED pacote (drc).\nSeleciona-se o objeto, o valor da varíavel resposta (50), e o tipo de intervalo de confiança que será apresentado.\n\nED(drc_fgt05, 50, interval = \"delta\")\n\n\nEstimated effective doses\n\n        Estimate Std. Error     Lower     Upper\ne:1:50  0.044839   0.019291 -0.016554  0.106231\n\n\nNo caso, a dose que inibe 50% da germinação de conídios foi estimada em 0.04, com -0.01 &lt; IC &lt; 0.10.\n\n\n\nI_165 &lt;- fung2 %&gt;% \n  filter(code ==\"165\")\n\ndrc_165 &lt;- drm(mean_germ ~ dose,\n                 data = I_165,\n                 fct = LL.3())\n\nsummary(drc_165)\n\n\nModel fitted: Log-logistic (ED50 as parameter) with lower limit at 0 (3 parms)\n\nParameter estimates:\n\n              Estimate Std. Error t-value   p-value    \nb:(Intercept)  1.21560    0.26679  4.5564 0.0198145 *  \nd:(Intercept) 36.14322    1.97554 18.2954 0.0003563 ***\ne:(Intercept)  0.55840    0.11420  4.8898 0.0163598 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error:\n\n 2.436519 (3 degrees of freedom)\n\nAIC(drc_165)\n\n[1] 31.55522\n\nplot(drc_165)\n\n\n\n\n\n\n\nED(drc_165,50, interval = \"delta\")\n\n\nEstimated effective doses\n\n       Estimate Std. Error   Lower   Upper\ne:1:50  0.55840    0.11420 0.19498 0.92182\n\n\n\nI_186 &lt;- fung2 %&gt;% \n  filter(code ==\"186\")\n\ndrc_186 &lt;- drm(mean_germ ~ dose,\n                 data = I_186,\n                 fct = LL.3())\n\nsummary(drc_186)\n\n\nModel fitted: Log-logistic (ED50 as parameter) with lower limit at 0 (3 parms)\n\nParameter estimates:\n\n               Estimate Std. Error t-value   p-value    \nb:(Intercept)  4.997636   0.542650  9.2097  0.002708 ** \nd:(Intercept) 48.750109   0.721642 67.5545 7.148e-06 ***\ne:(Intercept)  0.579757   0.013332 43.4853 2.677e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error:\n\n 1.020525 (3 degrees of freedom)\n\nAIC(drc_186)\n\n[1] 21.11219\n\nplot(drc_186)\n\n\n\n\n\n\n\nED(drc_186, 50, interval = \"delta\")\n\n\nEstimated effective doses\n\n       Estimate Std. Error    Lower    Upper\ne:1:50 0.579757   0.013332 0.537328 0.622187\n\n\n\n\n\n\nPelo método anterior, é preciso modelar o EC50 individualmente, o que pode ser trabalhoso, dependendo do número de amostras. Assim, o pacote ec50estimator é útil nessa situações, pois permite modelar, calcular a EC50 e o IC de todos os tratamento de uma só vez.\n\nlibrary(ec50estimator)\n\ndf_ec50 &lt;- estimate_EC50(mean_germ~dose,\n                         data = fung2,\n                         isolate_col = \"code\",\n                         interval = \"delta\",\n                         fct = drc::LL.3())\nview(df_ec50)\n\nlibrary(DT)\ndatatable(df_ec50)\n\n\n\n\n\nProblema, não é possível selecionar a função de cada modelo para melhor se adequar a cada tratamento.\nGráfico com as doses de EC50 e intervalo de confiança:\n\ndf_ec50 %&gt;% \n  ggplot(aes(reorder(ID, Estimate), Estimate))+\n  geom_point()+\n  geom_errorbar(aes(ymin = Lower,\n                    ymax = Upper),\n                width = 0.1)+\n  ylim (0, 1.2)+\n  coord_flip()\n\n\n\n\n\n\n\n\nArgumento reorder(ID, Estimate), Estimate , utilizado para ordenar os tratamentos em função da resposta (ordem crescente).",
    "crumbs": [
      "Home",
      "Análises",
      "Aula 10"
    ]
  }
]