{
  "hash": "77ea55ac22393e7c8a9ee2b8ce32bc73",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Aula 10\"\nformat: html\neditor: visual\nexecute: \n  error: false\n  warning: false\n---\n\n\nNesta aula, serão abordadas análises de correlação, demonstrando como construir gráficos e analisar os coeficientes obtidos. Também serão demonstradas análises de regressão linear e quadrática e, por fim, o uso de modelos não-lineares aplicados à fitopatologia para o cálculo de EC~50~.\n\n## Carregando os pacotes\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gsheet)\nlibrary(tidyverse)\nlibrary(patchwork)\nlibrary(AgroR)\n```\n:::\n\n\n## Análise de correlação\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncorr <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=373270992\")\n```\n:::\n\n\n### Análise exploratória - Visualização gráfica\n\n#### Gráfico de Correlação\n\nConsiderando o software \"Assess\" como o padrão, serão feitos gráficos de correlação entre ele e os outros softwares, \"LeafDoctor\" e \"ImageJ\". O objetivo é verificar se os métodos possuem alguma correlação com o \"Assess\" e se essa correlação é positiva ou negativa.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng1 <- corr %>% \n  ggplot(aes(Assess, LeafDoctor))+\n  geom_point()+\n  geom_smooth(method = \"lm\")\n\ng1\n```\n\n::: {.cell-output-display}\n![](Aula-10.1_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ng2 <- corr %>% \n  ggplot(aes(Assess, ImageJ))+\n  geom_point()+\n  geom_smooth(method = \"lm\")\n\ng2\n```\n\n::: {.cell-output-display}\n![](Aula-10.1_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nOs gráficos acima demonstram que os softwares avaliados possuem correlação positiva com o software \"Assess\".\n\n#### Boxplot\n\nSerá construído um boxplot para verificar a variabilidade dos dados em função do método (software).\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng3 <- corr %>%\n  pivot_longer(3:5, names_to = \"method\",\n               values_to = \"value\") %>% \n  ggplot(aes(method , value))+\n  geom_boxplot()\n\ng3\n```\n\n::: {.cell-output-display}\n![](Aula-10.1_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nCom o pacote **`patchwork`** será feito um plot contendo os três gráficos gerados anteriormente:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng3 + (g1/g2)\n```\n\n::: {.cell-output-display}\n![](Aula-10.1_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n### Coeficiente de correlação (r)\n\nO coeficiente de correlação (ou correlação de Pearson) varia entre -1 e +1. Se o valor for negativo, há correlação negativa; caso seja positivo, a correlação será positiva. Além disso, quanto mais próximo às extremidades (-1 ou +1), mais forte será a correlação.\n\nUma opção para obter os coeficientes de correlação (r) é adotar a função `cor.test` (nativa do R):\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncor.test(corr$Assess, corr$LeafDoctor)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  corr$Assess and corr$LeafDoctor\nt = 31.119, df = 68, p-value < 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.9466882 0.9792005\nsample estimates:\n      cor \n0.9666367 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncor.test(corr$Assess, corr$ImageJ)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  corr$Assess and corr$ImageJ\nt = 38.383, df = 68, p-value < 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.9642331 0.9861219\nsample estimates:\n      cor \n0.9776918 \n```\n\n\n:::\n:::\n\n\nPelo coeficientes obtidos, é possível dizer que os softwares possuem correlação positiva e forte, pois os valores\n\n#### Gráficos para apresentar os coeficientes de correlações entre os métodos\n\nCom **`AgroR`**:\n\nAntes é preciso criar um objeto com os coeficientes de correlação.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncorr %>% \n  select(3:5) %>%\n  corgraph()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        Var1       Var2       cor            p\n2 LeafDoctor     Assess 0.9666367 5.972544e-42\n3     ImageJ     Assess 0.9776918 8.143613e-48\n6     ImageJ LeafDoctor 0.9797478 3.144091e-49\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Aula-10.1_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#ou#\n\n\ncorr2 <- corr %>%\n  select(3:5)\n\ncorgraph(corr2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        Var1       Var2       cor            p\n2 LeafDoctor     Assess 0.9666367 5.972544e-42\n3     ImageJ     Assess 0.9776918 8.143613e-48\n6     ImageJ LeafDoctor 0.9797478 3.144091e-49\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Aula-10.1_files/figure-html/unnamed-chunk-9-2.png){width=672}\n:::\n:::\n\n\nCom **`corrplot`**:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(corrplot)\n\ncorr2_1 <- cor(corr2)\ncorrplot(corr2_1, method = \"square\", type = \"upper\")\n```\n\n::: {.cell-output-display}\n![](Aula-10.1_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nAlterando alguns parâmetros na função (conferir o help, pois há outras variações possíveis):\n\n-   O argumento `diag = FALSE` remove a comparação dentro de um mesmo método, por exemplo, Assess com Assess.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncorrplot(corr2_1, method = \"number\", type = \"upper\", diag = FALSE)\n```\n\n::: {.cell-output-display}\n![](Aula-10.1_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n### Exemplo 02\n\nUm outro exemplo de correlação, com o conjunto de dados de aulas passadas.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncampo <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=866852711\")\n\ncampo2 <- campo |> \n  dplyr::select(DFC, FER, PROD)\n```\n:::\n\n\nCom `corgraph`\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncorgraph(campo2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Var1 Var2        cor            p\n2  FER  DFC  0.9316978 9.864101e-15\n3 PROD  DFC -0.6928161 1.110652e-05\n6 PROD  FER -0.6258321 1.277444e-04\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Aula-10.1_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\nCom `corrplot`\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncampo2_1 <- cor(campo2)\ncampo2_1 %>% corrplot(method = \"number\", type = \"lower\", diag = FALSE)\n```\n\n::: {.cell-output-display}\n![](Aula-10.1_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n#### Comparação de correlações\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncor.test(campo2$PROD, campo2$DFC)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  campo2$PROD and campo2$DFC\nt = -5.2623, df = 30, p-value = 1.111e-05\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.8388581 -0.4537361\nsample estimates:\n       cor \n-0.6928161 \n```\n\n\n:::\n\n```{.r .cell-code}\ncor.test(campo2$PROD, campo2$FER)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  campo2$PROD and campo2$FER\nt = -4.3949, df = 30, p-value = 0.0001277\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.7999565 -0.3544981\nsample estimates:\n       cor \n-0.6258321 \n```\n\n\n:::\n:::\n\n\nAvalia-se os intervalos de confiança obtidos (IC da correlação entre PROD e DFC *vs.* IC da correlação entre PROD e FER) e caso não haja sobreposição de intervalos, as correlações diferem estatisticamente.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}