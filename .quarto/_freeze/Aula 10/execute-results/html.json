{
  "hash": "bd380cd55bb1c5db1e4d42d1fe27b758",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Aula 10\"\nauthor: \"Caio\"\nformat: html\neditor: visual\nexecute: \n  error: false\n  warning: false\n---\n\n\n# Aula 10\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gsheet)\nlibrary(tidyverse)\nlibrary(patchwork)\nlibrary(AgroR)\n```\n:::\n\n\n## Análise de correlação\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncorr <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=373270992\")\n```\n:::\n\n\n### Análise exploratória - Visualização gráfica\n\n#### Gráfico de Correlação\n\nConsiderando o software \"Assess\" como o padrão, serão feitos gráficos de correlação entre ele e os outros softwares, \"LeafDoctor\" e \"ImageJ\". O objetivo é verificar se os métodos possuem alguma correlação com o \"Assess\" e se essa correlação é positiva ou negativa.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng1 <- corr %>% \n  ggplot(aes(Assess, LeafDoctor))+\n  geom_point()+\n  geom_smooth(method = \"lm\")\n\ng1\n```\n\n::: {.cell-output-display}\n![](Aula-10_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ng2 <- corr %>% \n  ggplot(aes(Assess, ImageJ))+\n  geom_point()+\n  geom_smooth(method = \"lm\")\n\ng2\n```\n\n::: {.cell-output-display}\n![](Aula-10_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nOs gráficos acima demonstram que os softwares avaliados possuem correlação positiva com o software \"Assess\".\n\n#### Boxplot\n\nSerá construído um boxplot para verificar a variabilidade dos dados em função do método (software).\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng3 <- corr %>%\n  pivot_longer(3:5, names_to = \"method\",\n               values_to = \"value\") %>% \n  ggplot(aes(method , value))+\n  geom_boxplot()\n\ng3\n```\n\n::: {.cell-output-display}\n![](Aula-10_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nCom o pacote **`patchwork`** será feito um plot contendo os três gráficos gerados anteriormente:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng3 + (g1/g2)\n```\n\n::: {.cell-output-display}\n![](Aula-10_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n### Coeficiente de correlação (r)\n\nO coeficiente de correlação (ou correlação de Pearson) varia entre -1 e +1. Se o valor for negativo, há correlação negativa; caso seja positivo, a correlação será positiva. Além disso, quanto mais próximo às extremidades (-1 ou +1), mais forte será a correlação.\n\nUma opção para obter os coeficientes de correlação (r) é adotar a função `cor.test` (nativa do R):\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncor.test(corr$Assess, corr$LeafDoctor)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  corr$Assess and corr$LeafDoctor\nt = 31.119, df = 68, p-value < 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.9466882 0.9792005\nsample estimates:\n      cor \n0.9666367 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncor.test(corr$Assess, corr$ImageJ)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  corr$Assess and corr$ImageJ\nt = 38.383, df = 68, p-value < 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.9642331 0.9861219\nsample estimates:\n      cor \n0.9776918 \n```\n\n\n:::\n:::\n\n\nPelo coeficientes obtidos, é possível dizer que os softwares possuem correlação positiva e forte, pois os valores\n\n#### Gráficos para apresentar os coeficientes de correlações entre os métodos\n\nCom **`AgroR`**:\n\nAntes é preciso criar um objeto com os coeficientes de correlação.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncorr %>% \n  select(3:5) %>%\n  corgraph()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        Var1       Var2       cor            p\n2 LeafDoctor     Assess 0.9666367 5.972544e-42\n3     ImageJ     Assess 0.9776918 8.143613e-48\n6     ImageJ LeafDoctor 0.9797478 3.144091e-49\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Aula-10_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#ou#\n\n\ncorr2 <- corr %>%\n  select(3:5)\n\ncorgraph(corr2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        Var1       Var2       cor            p\n2 LeafDoctor     Assess 0.9666367 5.972544e-42\n3     ImageJ     Assess 0.9776918 8.143613e-48\n6     ImageJ LeafDoctor 0.9797478 3.144091e-49\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Aula-10_files/figure-html/unnamed-chunk-9-2.png){width=672}\n:::\n:::\n\n\nCom **`corrplot`**:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(corrplot)\n\ncorr2_1 <- cor(corr2)\ncorrplot(corr2_1, method = \"square\", type = \"upper\")\n```\n\n::: {.cell-output-display}\n![](Aula-10_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nAlterando alguns parâmetros na função (conferir o help, pois há outras variações possíveis):\n\n-   O argumento `diag = FALSE` remove a comparação dentro de um mesmo método, por exemplo, Assess com Assess.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncorrplot(corr2_1, method = \"number\", type = \"upper\", diag = FALSE)\n```\n\n::: {.cell-output-display}\n![](Aula-10_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n### Exemplo 02\n\nUm outro exemplo de correlação, com o conjunto de dados de aulas passadas.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncampo <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=866852711\")\n\ncampo2 <- campo |> \n  dplyr::select(DFC, FER, PROD)\n```\n:::\n\n\nCom `corgraph`\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncorgraph(campo2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Var1 Var2        cor            p\n2  FER  DFC  0.9316978 9.864101e-15\n3 PROD  DFC -0.6928161 1.110652e-05\n6 PROD  FER -0.6258321 1.277444e-04\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Aula-10_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\nCom `corrplot`\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncampo2_1 <- cor(campo2)\ncampo2_1 %>% corrplot(method = \"number\", type = \"lower\", diag = FALSE)\n```\n\n::: {.cell-output-display}\n![](Aula-10_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n#### Comparação de correlações\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncor.test(campo2$PROD, campo2$DFC)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  campo2$PROD and campo2$DFC\nt = -5.2623, df = 30, p-value = 1.111e-05\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.8388581 -0.4537361\nsample estimates:\n       cor \n-0.6928161 \n```\n\n\n:::\n\n```{.r .cell-code}\ncor.test(campo2$PROD, campo2$FER)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  campo2$PROD and campo2$FER\nt = -4.3949, df = 30, p-value = 0.0001277\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.7999565 -0.3544981\nsample estimates:\n       cor \n-0.6258321 \n```\n\n\n:::\n:::\n\n\nAvalia-se os intervalos de confiança obtidos (IC da correlação entre PROD e DFC *vs.* IC da correlação entre PROD e FER) e caso não haja sobreposição de intervalos, as correlações diferem estatisticamente.\n\n\\_\\_\\_\\_\n\n## Regressão linear de segunda ordem (quadrática)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nestande <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=401662555\")\n```\n:::\n\n\nNa aula anterior, foi visto que o ensaio 2 não apresentava uma tendência linear.\\\nEsse ensaio será utilizado para exemplificar uma regressão linear de segunda ordem.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexp2 <- estande %>% \n  filter(exp == 2)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nexp2 %>% \n  ggplot(aes(trat, nplants))+\n  geom_point()+\n  ylim(0,100)+\n  geom_smooth(method = \"lm\",\n              se = F,\n              color = \"green\",\n              formula = y ~ poly(x,2))+\n  geom_smooth(method = \"lm\",\n              se = F,\n              color = \"red\")\n```\n\n::: {.cell-output-display}\n![](Aula-10_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\nEm vermelho, a linha que indica o modelo linear de primeira ordem. Em verde, o modelo linear de segunda ordem.\n\n### Modelo linear\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm2 <- lm(nplants ~ trat,\n          data = exp2)\n\nsummary(lm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = nplants ~ trat, data = exp2)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-25.7816  -7.7150   0.5653   8.1929  19.2184 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  60.9857     3.6304  16.798 4.93e-14 ***\ntrat         -0.7007     0.1605  -4.365 0.000247 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.95 on 22 degrees of freedom\nMultiple R-squared:  0.4641,\tAdjusted R-squared:  0.4398 \nF-statistic: 19.05 on 1 and 22 DF,  p-value: 0.0002473\n```\n\n\n:::\n:::\n\n\nComo o resultado demonstra, para o modelo linear, o coeficiente de determinação é baixo (R^2^ = 0.43) , logo boa parte da variação dos dados não são explicados por esse modelo.\n\n### Modelo quadrático\n\nPara construir o modelo quadrático é preciso acrescentar uma coluna ao conjunto de dados, onde a varíavel independente (nesse caso, trat) será elevada ao quadrado. Isso é necessário para obtermos um segundo coeficiente no momento de criar o modelo.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexp2$trat2 <- exp2$trat^2\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlm2_quad <- lm(nplants ~ trat + trat2,\n               data = exp2)\nsummary(lm2_quad)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = nplants ~ trat + trat2, data = exp2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-25.439  -6.019   1.789   8.016  19.561 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 66.30156    4.42097  14.997 1.08e-12 ***\ntrat        -1.77720    0.58467  -3.040  0.00623 ** \ntrat2        0.02223    0.01166   1.906  0.07036 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.24 on 21 degrees of freedom\nMultiple R-squared:  0.5432,\tAdjusted R-squared:  0.4997 \nF-statistic: 12.49 on 2 and 21 DF,  p-value: 0.0002675\n```\n\n\n:::\n:::\n\n\nCom a função `polynomial` (**`AgroR`**):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(exp2, polynomial(trat, nplants, grau = 2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n----------------------------------------------------\nRegression Models\n----------------------------------------------------\n               Estimate Std. Error   t value     Pr(>|t|)\n(Intercept) 66.30156250 4.42096799 14.997069 1.079972e-12\ntrat        -1.77719814 0.58467380 -3.039640 6.230050e-03\nI(trat^2)    0.02222876 0.01165948  1.906496 7.036247e-02\n\n----------------------------------------------------\nDeviations from regression\n----------------------------------------------------\n          Df       SSq       MSQ         F      p-value\nLinear     1 3196.2031 3196.2031 21.823293 0.0001899378\nQuadratic  1  544.5029  544.5029  3.717801 0.0697619482\nDeviation  3  509.6690  169.8897  1.159986 0.3523240106\nResidual  18 2636.2500  146.4583                       \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[[1]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Aula-10_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\n### Comparando os AICs\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAIC(lm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 194.9597\n```\n\n\n:::\n\n```{.r .cell-code}\nAIC(lm2_quad)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 193.1284\n```\n\n\n:::\n:::\n\n\nPelo teste de AIC, em comparação ao modelo linear, o modelo quadrático explica melhor a variação dos dados, pois AIC(lm2_quad) \\< AIC(lm2).\n\n#### Modelo de terceira ordem - teste\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(exp2, polynomial(trat, nplants, grau = 3))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n----------------------------------------------------\nRegression Models\n----------------------------------------------------\n                Estimate  Std. Error   t value     Pr(>|t|)\n(Intercept) 70.265143802 5.300440019 13.256474 2.295186e-11\ntrat        -3.609380523 1.514625525 -2.383018 2.720299e-02\nI(trat^2)    0.140522077 0.091192577  1.540938 1.390058e-01\nI(trat^3)   -0.001712445 0.001309648 -1.307561 2.058546e-01\n\n----------------------------------------------------\nDeviations from regression\n----------------------------------------------------\n          Df       SSq       MSQ          F      p-value\nLinear     1 3196.2031 3196.2031 21.8232929 0.0001899378\nQuadratic  1  544.5029  544.5029  3.7178008 0.0697619482\nCubic      1  247.7520  247.7520  1.6916208 0.2097934169\nDeviation  2  261.9170  130.9585  0.8941691 0.4263523326\nResidual  18 2636.2500  146.4583                        \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[[1]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Aula-10_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\nApesar do polinômio de grau 3 explicar melhor os dados, o modelo não possui explicação biológica plausível (do estande de plantas aumentar em função do aumento do inóculo para depois decrescer).\n\n## Modelo não--linear\n\nAplicação na fitopatologia, em curvas de EC~50~.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfung <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=465348652\")\n```\n:::\n\n\nCálculo da média de germinação em função do isolado.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfung2 <- fung %>% \n  group_by(code, dose) %>% \n  summarise(mean_germ = mean(germination))\n```\n:::\n\n\n\\\nVisualização da média de germinação com gráfico de pontos\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfung2 %>% \n  ggplot(aes(dose, mean_germ))+\n  geom_point()+\n  facet_wrap(~ code)\n```\n\n::: {.cell-output-display}\n![](Aula-10_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n### Modelagem da EC~50~ (modelo não-linear)\n\nPara modelar a EC~50~ será utilizado o pacote **`drc`**, com a função `drm`.\n\nAntes, é preciso criar um novo objeto somente com os dados do isolado selecionado (ex.: FGT05). Em seguida, definimos na função `drm` que a germinação média será modela em função da dose, qual o conjunto de dados (`data = FGT05`) e qual a função utilizada (no caso, `fct = LL.3()`).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(drc)\n\nFGT05 <- fung2 %>% \n  filter(code ==\"FGT05\")\n\ndrc_fgt05 <- drm(mean_germ ~ dose,\n                 data = FGT05,\n                 fct = LL.3())\n\nsummary(drc_fgt05)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nModel fitted: Log-logistic (ED50 as parameter) with lower limit at 0 (3 parms)\n\nParameter estimates:\n\n               Estimate Std. Error t-value   p-value    \nb:(Intercept)  0.769933   0.198566  3.8775 0.0303750 *  \nd:(Intercept) 44.924753   3.261699 13.7734 0.0008283 ***\ne:(Intercept)  0.044839   0.019291  2.3243 0.1026764    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error:\n\n 3.253867 (3 degrees of freedom)\n```\n\n\n:::\n\n```{.r .cell-code}\nAIC(drc_fgt05)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 35.02651\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(drc_fgt05)\n```\n\n::: {.cell-output-display}\n![](Aula-10_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\nÉ importante definir a função para comparar os modelos e selecionar aquele mais simples (com menor AIC).\n\n### Cálculo de EC~50~\n\nSerá utilizada a função `ED` pacote (**`drc`**).\n\nSeleciona-se o objeto, o valor da varíavel resposta (50), e o tipo de intervalo de confiança que será apresentado.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nED(drc_fgt05, 50, interval = \"delta\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nEstimated effective doses\n\n        Estimate Std. Error     Lower     Upper\ne:1:50  0.044839   0.019291 -0.016554  0.106231\n```\n\n\n:::\n:::\n\n\nNo caso, a dose que inibe 50% da germinação de conídios foi estimada em 0.04, com -0.01 \\< IC \\< 0.10.\n\n#### Outros exemplos\n\n\n::: {.cell}\n\n```{.r .cell-code}\nI_165 <- fung2 %>% \n  filter(code ==\"165\")\n\ndrc_165 <- drm(mean_germ ~ dose,\n                 data = I_165,\n                 fct = LL.3())\n\nsummary(drc_165)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nModel fitted: Log-logistic (ED50 as parameter) with lower limit at 0 (3 parms)\n\nParameter estimates:\n\n              Estimate Std. Error t-value   p-value    \nb:(Intercept)  1.21560    0.26679  4.5564 0.0198145 *  \nd:(Intercept) 36.14322    1.97554 18.2954 0.0003563 ***\ne:(Intercept)  0.55840    0.11420  4.8898 0.0163598 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error:\n\n 2.436519 (3 degrees of freedom)\n```\n\n\n:::\n\n```{.r .cell-code}\nAIC(drc_165)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 31.55522\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(drc_165)\n```\n\n::: {.cell-output-display}\n![](Aula-10_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n\n```{.r .cell-code}\nED(drc_165,50, interval = \"delta\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nEstimated effective doses\n\n       Estimate Std. Error   Lower   Upper\ne:1:50  0.55840    0.11420 0.19498 0.92182\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nI_186 <- fung2 %>% \n  filter(code ==\"186\")\n\ndrc_186 <- drm(mean_germ ~ dose,\n                 data = I_186,\n                 fct = LL.3())\n\nsummary(drc_186)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nModel fitted: Log-logistic (ED50 as parameter) with lower limit at 0 (3 parms)\n\nParameter estimates:\n\n               Estimate Std. Error t-value   p-value    \nb:(Intercept)  4.997636   0.542650  9.2097  0.002708 ** \nd:(Intercept) 48.750109   0.721642 67.5545 7.148e-06 ***\ne:(Intercept)  0.579757   0.013332 43.4853 2.677e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error:\n\n 1.020525 (3 degrees of freedom)\n```\n\n\n:::\n\n```{.r .cell-code}\nAIC(drc_186)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 21.11219\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(drc_186)\n```\n\n::: {.cell-output-display}\n![](Aula-10_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n\n```{.r .cell-code}\nED(drc_186, 50, interval = \"delta\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nEstimated effective doses\n\n       Estimate Std. Error    Lower    Upper\ne:1:50 0.579757   0.013332 0.537328 0.622187\n```\n\n\n:::\n:::\n\n\n### Calculando os EC~50~ de uma só vez\n\nPelo método anterior, é preciso modelar o EC~50~ individualmente, o que pode ser trabalhoso, dependendo do número de amostras. Assim, o pacote **`ec50estimator`** é útil nessa situações, pois permite modelar, calcular a EC~50~ e o IC de todos os tratamento de uma só vez.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ec50estimator)\n\ndf_ec50 <- estimate_EC50(mean_germ~dose,\n                         data = fung2,\n                         isolate_col = \"code\",\n                         interval = \"delta\",\n                         fct = drc::LL.3())\nview(df_ec50)\n\nlibrary(DT)\ndatatable(df_ec50)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-d4564993db4ca39052dc\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-d4564993db4ca39052dc\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\"],[\"152\",\"153\",\"164\",\"165\",\"169\",\"170\",\"186\",\"187\",\"188\",\"189\",\"FGT05\",\"FGT06\",\"FGT07\",\"FGT28\",\"FGT29\",\"FGT33\",\"FGT34\",\"FGT35\",\"FGT42\",\"FGT43\"],[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"],[0.4443562921134181,0.2037966428294141,0.5077584385578893,0.5583961307217543,0.1472231103670195,0.375038891910268,0.5797574354294909,0.2156333836945371,0.1529717175030145,0.5310619333335561,0.04483862111325968,0.5449794616939213,0.8877005267670349,0.2260814114629881,0.2360165168159889,0.1048162725943343,0.1477311423537533,0.2031539246265511,0.4500055864313668,0.4958954876770452],[0.07778923986155871,0.04237351183067169,0.04724826570185957,0.1141951132324397,0.009555687975666576,0.04320732845193305,0.01333226808004392,0.03663944561893181,0.004284690501602993,0.02313093593948798,0.01929089015844035,0.03483460212348276,0.07991770412951832,0.03360074200920896,0.03493388051850937,0.01306522050908054,0.04700337288810025,0.0389846040830016,0.05968588958303524,0.06085077057586942],[0.1967962131251725,0.06894521666199757,0.3573933699439433,0.1949763145337218,0.1168126464744155,0.237533889117234,0.5373282081371031,0.09903031535692423,0.1393359200469039,0.4574489717151785,-0.01655360099710266,0.4341202108700156,0.6333667245332928,0.11914885420099,0.1248413178306362,0.06323690985749403,-0.001854568029853731,0.07908751539965447,0.260058447650265,0.302241177684203],[0.6919163711016638,0.3386480689968308,0.6581235071718352,0.9218159469097869,0.1776335742596236,0.5125438947033019,0.6221866627218786,0.33223645203215,0.1666075149591251,0.6046748949519338,0.106230843223622,0.655838712517827,1.142034329000777,0.3330139687249862,0.3471917158013415,0.1463956353311746,0.2973168527373604,0.3272203338534477,0.6399527252124686,0.6895497976698874]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>ID<\\/th>\\n      <th>strata<\\/th>\\n      <th>Estimate<\\/th>\\n      <th>Std..Error<\\/th>\\n      <th>Lower<\\/th>\\n      <th>Upper<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4,5,6]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"ID\",\"targets\":1},{\"name\":\"strata\",\"targets\":2},{\"name\":\"Estimate\",\"targets\":3},{\"name\":\"Std..Error\",\"targets\":4},{\"name\":\"Lower\",\"targets\":5},{\"name\":\"Upper\",\"targets\":6}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\nProblema, não é possível selecionar a função de cada modelo para melhor se adequar a cada tratamento.\n\nGráfico com as doses de EC~50~ e intervalo de confiança:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_ec50 %>% \n  ggplot(aes(reorder(ID, Estimate), Estimate))+\n  geom_point()+\n  geom_errorbar(aes(ymin = Lower,\n                    ymax = Upper),\n                width = 0.1)+\n  ylim (0, 1.2)+\n  coord_flip()\n```\n\n::: {.cell-output-display}\n![](Aula-10_files/figure-html/unnamed-chunk-33-1.png){width=672}\n:::\n:::\n\n\nArgumento `reorder(ID, Estimate), Estimate` , utilizado para ordenar os tratamentos em função da resposta (ordem crescente).\n",
    "supporting": [
      "Aula-10_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/datatables-binding-0.33/datatables.js\"></script>\n<script src=\"site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<link href=\"site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}