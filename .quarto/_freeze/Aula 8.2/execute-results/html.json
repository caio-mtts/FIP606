{
  "hash": "9dffd77a6c45a29cbe00297c833bc82f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Aula 8\"\nformat: html\neditor: visual\nexecute: \n  error: false\n  warning: false\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n\n## Curva de progresso da doença\n\n### Importando os dados\n\nPara construção de uma curva de progresso da doença usaremos como exemplo um conjunto de dados que descreve diferentes métodos de irrigação (variável independente, um fator, 2 níveis) e seu efeito sobre a severidade (variável dependente) ao longo dos dias.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncurve <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1807247585\")\n\ncurve$severity2 <- (curve$severity*100)\n```\n:::\n\n\nComo os dados de severidade são apresentados em valores decimais, é possível colocá-los em porcentagem fazendo multiplicação por 100.\n\nPara construir a curva, primeiro é preciso agrupar os dados (`group_by`) em função do método de irrigação e do dia. Em seguida, é calculada a média em função das mesmas variáveis (dia e irrigação) com a função `summarise(sev_mean = mean(sev_X))`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncurve2 <- curve %>% \n  group_by(Irrigation, day) %>% \n  summarise(sev_mean = mean(severity))\n\ncurve2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 20 × 3\n# Groups:   Irrigation [2]\n   Irrigation   day sev_mean\n   <chr>      <dbl>    <dbl>\n 1 Drip           0   0.01  \n 2 Drip           7   0.0367\n 3 Drip          14   0.107 \n 4 Drip          21   0.117 \n 5 Drip          28   0.153 \n 6 Drip          35   0.18  \n 7 Drip          42   0.323 \n 8 Drip          49   0.357 \n 9 Drip          56   0.42  \n10 Drip          63   0.43  \n11 Furrow         0   0.01  \n12 Furrow         7   0.04  \n13 Furrow        14   0.103 \n14 Furrow        21   0.103 \n15 Furrow        28   0.157 \n16 Furrow        35   0.187 \n17 Furrow        42   0.353 \n18 Furrow        49   0.383 \n19 Furrow        56   0.413 \n20 Furrow        63   0.45  \n```\n\n\n:::\n:::\n\n\n### Visualização gráfica\n\nPara conhecer o comportamento da severidade ao longo do tempo, será construído um gráfico de pontos (`geom_point`) e linhas (`geom_line`), diferenciando os tratamentos (\"Irrigation\") pela cor:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncurve2 %>% \n  ggplot(aes(day, sev_mean, colour = Irrigation))+\n  geom_point()+\n  geom_line()\n```\n\n::: {.cell-output-display}\n![](Aula-8.2_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nOu, uma figura com dois gráficos. Um para cada nível do fator \"Irrigation\":\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncurve2 %>% \n  ggplot(aes(day, sev_mean))+\n  geom_point()+\n  geom_line()+\n  facet_wrap(~Irrigation)\n```\n\n::: {.cell-output-display}\n![](Aula-8.2_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n### Cálculo da área abaixo da curva de progresso da doença\n\nPara o cálculo da área abaixo da curva de progresso da doença (AACPD, ou \"*area under the disease progress curve\",* AUDPC), será criado um novo dataframe. Para isso, será feito o agrupamento (`group_by`) das variáveis em função do tratamento (\"Irrigation\") e das repetições (\"rep\"). Em seguida, será utilizada a função `summarise` para o cálculo da AACPD (função `AUDPC`, pacote **`epifitter`**).\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncurve3 <- curve %>% \n  group_by(Irrigation, rep) %>% \n  summarise(aacpd = AUDPC(day, severity))\n\ncurve3\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 3\n# Groups:   Irrigation [2]\n  Irrigation   rep aacpd\n  <chr>      <dbl> <dbl>\n1 Drip           1  13.0\n2 Drip           2  13.9\n3 Drip           3  13.3\n4 Furrow         1  13.5\n5 Furrow         2  14.1\n6 Furrow         3  13.7\n```\n\n\n:::\n:::\n\n\n### ANOVA\n\nAntes de realizar análise de variância é preciso estabelece um modelo, o que será com os valores de AACPD e a função (`lm`):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm_curve <- lm(aacpd ~ Irrigation+factor(rep),\n              data = curve3)\n```\n:::\n\n\n#### Avaliação das pressuposições\n\nCom funções do pacote **`Performance`**:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_normality(m_curve)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: residuals appear as normally distributed (p = 0.380).\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m_curve)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: Error variance appears to be homoscedastic (p = 0.704).\n```\n\n\n:::\n:::\n\n\nCom o pacote **`DHARMa`**:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(simulateResiduals(m_curve))\n```\n\n::: {.cell-output-display}\n![](Aula-8.2_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nCom o teste de Shapiro-Wilk (`shapiro.test`) e o teste de Bartlett (`bartlett.test`):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(m_curve$residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  m_curve$residuals\nW = 0.90104, p-value = 0.3801\n```\n\n\n:::\n\n```{.r .cell-code}\nbartlett.test (aacpd ~ Irrigation,\n               data = curve3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  aacpd by Irrigation\nBartlett's K-squared = 0.46162, df = 1, p-value = 0.4969\n```\n\n\n:::\n:::\n\n\nAmbas as metodologias demonstram que os dados seguem distribuição normal e possuem homocedasticidade, logo é possível proceder análise de variância.\n\n#### ANOVA\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(m_curve)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: aacpd\n            Df  Sum Sq  Mean Sq F value  Pr(>F)  \nIrrigation   1 0.23602 0.236017  10.605 0.08275 .\nfactor(rep)  2 0.61291 0.306454  13.771 0.06770 .\nResiduals    2 0.04451 0.022254                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\nA ANOVA mostra que não há diferença entre as áreas.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nagricolae::cv.model(m_curve)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.097572\n```\n\n\n:::\n:::\n\n\nO que poderia ser explicado pelo coeficiente de variação do experimento, que foi muito baixo (CV = 1.09 %).\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}