{
  "hash": "c6762610187ae1d78fd4be2fc26860e4",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Aula 6\"\nformat: html\neditor: visual\nexecute: \n  error: false\n  warning: false\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## Análise de Variância (ANOVA)\n\nA análise de variância é adotada quando desejamos comparar três ou mais variáveis quantitativas independentes e que possuem distribuição normal.\n\n### Exemplo 1) sem diferença estatística\n\n### Análise exploratória - obtenção e visualização dos dados\n\nOs dados serão importados de uma planilha excel e apresentam a taxa de crescimento micelial de 5 espécies de *Fusarium*.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmicelial <- readxl::read_excel(\"dados-diversos.xlsx\",\n                               sheet = \"micelial\")\nglimpse(micelial)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 42\nColumns: 3\n$ especie <chr> \"Fasi\", \"Fasi\", \"Fasi\", \"Fasi\", \"Fasi\", \"Fasi\", \"Faus\", \"Faus\"…\n$ rep     <dbl> 1, 2, 3, 4, 5, 6, 1, 2, 3, 4, 5, 6, 1, 2, 3, 4, 5, 6, 7, 8, 9,…\n$ tcm     <dbl> 1.50, 1.59, 1.52, 1.52, 1.24, 1.29, 1.52, 1.25, 1.27, 0.88, 1.…\n```\n\n\n:::\n\n```{.r .cell-code}\n#tcm = taxa de crescimento micelial\n```\n:::\n\n\nPara visualização dos dados, será construído um simples gráfico de pontos (`geom_jitter`) ao invés de boxplots (`geom_boxplot`).\\\nComo cada tratamento possui em torno de 10 respostas (pontos), esse tipo de gráfico já é suficiente para visualizar a distribuição dos valores.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmicelial %>% \n  ggplot(aes(especie, tcm))+\n  geom_jitter(width = 0.1)\n```\n\n::: {.cell-output-display}\n![](Aula-6.2_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n### Análise inferencial - ANOVA\n\n#### Construção do modelo\n\nAntes de realizar a ANOVA, é preciso ajustar um modelo linear (lm). Para isso, será utilizada a função `lm`. Nessa função, os modelos são construídos simbolicamente: com a variável dependente, seguida de um `~`, e a variável independente. Em seguida, informamos no argumento `data` qual o conjunto de dados (data frame) que contém as variáveis do modelo.\\\nEssa fórmula será atribuída a um objeto.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 <- lm(tcm ~ especie, data = micelial)\n```\n:::\n\n\n#### Avaliação das premissas\n\nUma vez construído o modelo, é necessário determinar se os dados satisfazem as premissas para proceder a análise de variância.\n\n#### Normalidade\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(m1$residuals)\n```\n\n::: {.cell-output-display}\n![](Aula-6.2_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n```{.r .cell-code}\nshapiro.test(m1$residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  m1$residuals\nW = 0.95101, p-value = 0.07022\n```\n\n\n:::\n:::\n\n\nTanto visualmente, quanto estatisticamente, os resíduos possuem distribuição normal.\n\n#### Homogeneidade\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbartlett.test(tcm ~ especie, data = micelial)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  tcm by especie\nBartlett's K-squared = 3.1169, df = 4, p-value = 0.5385\n```\n\n\n:::\n:::\n\n\nO teste de Barlett indica que o conjunto de dados possui homogeneidade de variância.\n\n#### ANOVA\n\nO modelo criado é utilizado dentro da função `anova`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: tcm\n          Df  Sum Sq Mean Sq F value Pr(>F)\nespecie    4 0.46917 0.11729   1.983 0.1173\nResiduals 37 2.18853 0.05915               \n```\n\n\n:::\n:::\n\n\nCom esse conjunto de dados, é possível concluir que as taxas de crescimento micelial das espécies de *Fusarium* não diferem significativamente entre si (F = 0.1173 \\> ⍺ = 0.05).\n\n\\\nA função `summary` será aplicada para produzir um sumário dos resultados do modelo ajustado.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = tcm ~ especie, data = micelial)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.45933 -0.20028  0.06067  0.14017  0.36167 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  1.44333    0.09929  14.537   <2e-16 ***\nespecieFaus -0.28500    0.14042  -2.030   0.0496 *  \nespecieFcor -0.28400    0.11748  -2.417   0.0207 *  \nespecieFgra -0.30000    0.14042  -2.137   0.0393 *  \nespecieFmer -0.14222    0.12818  -1.110   0.2744    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2432 on 37 degrees of freedom\nMultiple R-squared:  0.1765,\tAdjusted R-squared:  0.08751 \nF-statistic: 1.983 on 4 and 37 DF,  p-value: 0.1173\n```\n\n\n:::\n:::\n\n\nO intercepto indica a média do primeiro nível (*Fasi* = 1.43) e em seguida são apresentados as diferenças para cada nível em relação ao primeiro. Por exemplo, a média da taxa de crescimento micelial do nível *Faus* será 1.15 (1.43 - 0.28).\\\n\\\n\nO intercepto pode ser removido incluindo `-1` na construção do modelo. Dessa forma, serão apresentados os valores de média de cada nível:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm2 <- lm(tcm ~ especie - 1, data = micelial)\nsummary(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = tcm ~ especie - 1, data = micelial)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.45933 -0.20028  0.06067  0.14017  0.36167 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \nespecieFasi  1.44333    0.09929   14.54  < 2e-16 ***\nespecieFaus  1.15833    0.09929   11.67 5.85e-14 ***\nespecieFcor  1.15933    0.06280   18.46  < 2e-16 ***\nespecieFgra  1.14333    0.09929   11.52 8.56e-14 ***\nespecieFmer  1.30111    0.08107   16.05  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2432 on 37 degrees of freedom\nMultiple R-squared:  0.9668,\tAdjusted R-squared:  0.9623 \nF-statistic: 215.7 on 5 and 37 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n### Exemplo 2) com diferença estatística\n\nUm conjunto de dados similar ao anterior será importado de uma planilha online. Nesse novo conjunto os dados foram alterados para apresentarem diferença estatística e avançarmos na análise inferencial.\\\n\n### Análise exploratória - obtenção e visualização dos dados\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmicelial2 <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=959387827\")\n\n#tcm = taxa de crescimento micelial\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmicelial2 %>% \n  ggplot(aes(especie, tcm))+\n  geom_jitter(width = 0.1)\n```\n\n::: {.cell-output-display}\n![](Aula-6.2_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n#### Construção do modelo\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm3 <- lm(tcm ~ especie, data = micelial2)\n```\n:::\n\n\n#### Avaliação das premissas\n\n#### Normalidade\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(m3$residuals)\n```\n\n::: {.cell-output-display}\n![](Aula-6.2_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n\n```{.r .cell-code}\nshapiro.test(m3$residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  m3$residuals\nW = 0.9821, p-value = 0.8782\n```\n\n\n:::\n:::\n\n\nTanto visualmente, quanto estatisticamente, os resíduos possuem distribuição normal.\n\n#### Homogeneidade\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbartlett.test(tcm ~ especie, data = micelial2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  tcm by especie\nBartlett's K-squared = 4.4367, df = 4, p-value = 0.3501\n```\n\n\n:::\n:::\n\n\nO teste de Barlett indica que o conjunto de dados possui homogeneidade de variância.\n\n### Análise inferencial - ANOVA\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(m3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: tcm\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nespecie    4 1.46958 0.36739  19.629 2.028e-07 ***\nResiduals 25 0.46792 0.01872                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(m3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = tcm ~ especie, data = micelial2)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.23667 -0.09667  0.01583  0.08833  0.28333 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  1.57167    0.05585  28.140  < 2e-16 ***\nespecieFaus -0.33500    0.07899  -4.241 0.000266 ***\nespecieFcor -0.25000    0.07899  -3.165 0.004047 ** \nespecieFgra -0.66000    0.07899  -8.356 1.05e-08 ***\nespecieFmer -0.14500    0.07899  -1.836 0.078317 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1368 on 25 degrees of freedom\nMultiple R-squared:  0.7585,\tAdjusted R-squared:  0.7199 \nF-statistic: 19.63 on 4 and 25 DF,  p-value: 2.028e-07\n```\n\n\n:::\n:::\n\n\nCom esse novo conjunto de dados, conclui-se que as taxas de crescimento micelial das espécies de *Fusarium* diferem significativamente entre si (F = 2.2 \\* 10^-7^ \\> ⍺ = 0.05). O próximo passo será adotar um teste de comparação de médias para conhecer como as espécies se agrupam quanto as taxas de crescimento.\n\n### Comparação de médias - Teste de Tukey\n\nPara realizar o teste de Tukey, utilizaremos os pacotes `emmeans`, `multcomp` e `multcompview`.\n\nInicialmente, a função `emmeans` (pacote `emmeans`) será aplicada para estimar as médias de um fator específico em um modelo linear. O resultado será atribuído a um objeto.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmedias1 <- emmeans(m3, ~ especie)\n```\n:::\n\n\nPara comparação de médias - Teste de Tukey - será utilizada a função `cld` (pacote `multcomp`).\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncld(medias1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n especie emmean     SE df lower.CL upper.CL .group\n Fgra     0.912 0.0559 25    0.797     1.03  1    \n Faus     1.237 0.0559 25    1.122     1.35   2   \n Fcor     1.322 0.0559 25    1.207     1.44   2   \n Fmer     1.427 0.0559 25    1.312     1.54   23  \n Fasi     1.572 0.0559 25    1.457     1.69    3  \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 5 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n:::\n\n\nCom o resultado obtido a um nível de significância de 5%, interpretamos que *Fgra* possui a menor taxa de crescimento, em comparação as demais espécies. *Faus*, *Fcor* e *Fmer* possuem taxa de crescimento estatisticamente similar. Já *Fmer* e *Fasi* são estatisticamente similares e possuem a maior taxa de crescimento.\n\n### Alternativas para verificação das premissas\n\n#### Pacote `DHARMa`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(simulateResiduals(m3))\n```\n\n::: {.cell-output-display}\n![](Aula-6.2_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\n#### Pacote `performance`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(performance)\ncheck_normality(m3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: residuals appear as normally distributed (p = 0.878).\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: Error variance appears to be homoscedastic (p = 0.880).\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_model(m3)\n```\n\n::: {.cell-output-display}\n![](Aula-6.2_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}