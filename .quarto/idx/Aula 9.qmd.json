{"title":"Aula 9","markdown":{"yaml":{"title":"Aula 9","author":"Caio","format":"html","editor":"visual","execute":{"error":false,"warning":false}},"headingText":"Aula 9","containsRefs":false,"markdown":"\n\n\n## Carregando pacotes\n\n```{r}\nlibrary(gsheet)\nlibrary(tidyverse)\nlibrary(lme4)\nlibrary(car)\nlibrary(performance)\nlibrary(DHARMa)\nlibrary(emmeans)\nlibrary(multcomp)\nlibrary(multcompView)\nlibrary(patchwork)\nlibrary(r4pde)\n```\n\n## Análise de um experimento em parcelas subdivididas\n\nExperimentos em parcelas subdivididas são utilizados quando o nível de um fator primário (ou tratamento) é aplicado a uma parcela relativamente grande e todos os níveis de um segundo fator secundário são aplicados às subparcelas desta parcela maior. Os tratamentos primários são distribuídos às parcelas de acordo com um delineamento especificado, já os tratamentos secundários são distribuídos às subparcelas de forma aleatória.\\\n\n## Importando os dados\n\nPara exemplificar a análise de um experimento em parcelas subdivididas, será utilizado um conjunto de dados onde o objetivo foi avaliar o índice de doença e produtividade de híbridos de milho (fator primário) ao serem submetidos a dois métodos de inoculação (fator secundário). Um esboço desse arranjo experimental é apresentado abaixo.\n\n![Experimento em parcelas subdivididas.](Imagem1.png){width=\"1650\"}\n\n```{r}\nmilho <- gsheet::gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1345524759\")\n```\n\n```{r}\nglimpse(milho)\n```\n\n## Visualização gráfica\n\n### Índice de doença\n\nPara visualização dos dados relacionados ao índice de doença e o método de inoculação será construído um gráfico de pontos (`geom_jitter`) acrescido do intervalo de confiança (`stat_summary(fund.data = \"mean_cl_boot\"`). Para gerar uma figura com os gráficos individuais de cada tratamento é utilizada a função `facet_wrap`.\n\n```{r}\nmilho %>% \n  ggplot(aes(method, index))+\n  geom_jitter(color = \"darkred\", width = 0.1, alpha = 0.4)+\n  stat_summary(fund.data = \"mean_cl_boot\", color = \"black\", width = 0.5)+\n  facet_wrap (~hybrid)\n```\n\n### Produtividade\n\nPara os dados relacionados à produtividade e o método de inoculação será construído um gráfico de similar ao anterior.\n\n```{r}\nmilho %>% \n  ggplot(aes(method, yield))+\n  geom_jitter(color = \"darkred\", width = 0.1, alpha = 0.4)+\n  stat_summary(fund.data = \"mean_cl_boot\", color = \"black\", width = 0.5)+\n  facet_wrap (~hybrid)\n```\n\n## Análise em parcelas subdivididas\n\n## Índice de doença (index)\n\n### Construção do modelo\n\nAntes de definir o modelo, será preciso transformar a coluna de dados \"block\" para fator (funções `mutate` e `as.factor`).\n\n```{r}\nmilho <- milho %>% \n  mutate(block = as.factor(block))\n```\n\nPara a análise dos dados, será construído um modelo linear de efeitos mistos com a função `lmer` (pacote **`lme4`**), onde definimos os fatores fixos e os fatores aleatórios.\n\n```{r}\nmix <- lmer(index ~ hybrid*method + block + (1|block/hybrid),\n            data = milho)\n```\n\n### ANOVA\n\n```{r}\nAnova(mix)\n```\n\nA análise de variância demonstra que há interação entre os fatores (hybrid:method). Assim seria preciso realizar os desdobramentos e comparar híbridos dentro de métodos e métodos dentro de híbridos. Mas antes, é preciso conferir se os dados atendem às pressuposições da ANOVA.\n\n### Avaliação das premissas\n\n```{r}\ncheck_normality(mix)\ncheck_heteroscedasticity(mix)\n```\n\n```{r}\nplot(simulateResiduals(mix))\n```\n\nCom as análises acima, conclui-se que os dados seguem distribuição normal. Porém, não há homogeneidade de variância entre os grupos. Logo será preciso uma alternativa para prosseguir a análise, por exemplo a transformação dos dados com raiz quadrada.\n\n### Transformação dos dados - Raiz quadrada\n\n```{r}\nmix2 <- lmer(sqrt(index) ~ hybrid*method + block + (1|block/hybrid),\n            data = milho)\n```\n\n#### ANOVA - Dados transformados\n\n```{r}\nanova(mix2)\n```\n\n#### Avaliação das premissas - Dados transformados\n\nCom as funções `check_normality` e `check_heteroscedasticity` (pacote **`Performance`**):\n\n```{r}\ncheck_normality(mix2)\ncheck_heteroscedasticity(mix2)\n```\n\nAtravés de um gráfico Q-Q (funções `qqnorm` e `qqline`):\n\n```{r}\nqqnorm(residuals(mix2))\nqqline(residuals(mix2))\n```\n\nCom a função `simulateResiduals` (pacote **`DHARMa`**):\n\n```{r}\nplot(simulateResiduals(mix2))\n```\n\nApesar da análise via **`DHARMa`** ter apresentado problemas, as demais avaliações (via **`Performance`** e QQ-Plot) se mostraram favoráveis, logo é possível prosseguir para a comparação de médias.\n\n#### Comparação de médias - Dados transformados\n\nComo visto pela ANOVA, há efeito de interação, logo será preciso realizar desdobramentos para as comparações:\n\n##### Híbridos dentro de métodos:\n\n```{r}\nindex <- emmeans(mix2, ~hybrid | method,\n                 type = \"response\")\n\ncld(index, Letters = LETTERS)\n```\n\n##### Métodos dentro de híbridos\n\n```{r}\nindex2 <- emmeans(mix2, ~method | hybrid,\n                  type = \"response\")\n\ncld(index2, Letters = letters)\n```\n\n## Produtividade (yield)\n\nSeguindo os mesmos procedimentos para o índice de doença, será conduzida avaliação da produtividade.\n\n### Construção do modelo\n\n```{r}\nmix3 <- lmer(yield ~ hybrid*method + block + (1|block/hybrid),\n            data = milho)\n```\n\n### ANOVA\n\n```{r}\nAnova(mix3)\n```\n\n### Avaliação das premissas\n\n```{r}\ncheck_normality(mix3)\ncheck_heteroscedasticity(mix3)\n```\n\nA análise pelas funções check_normality e check_heteroscedasticity demonstram que os dados possuem normalidade na distribuição dos resíduos, no entanto, não há homogeneidade de variância entre os grupos. Portanto, também será preciso realizar transformação.\n\n#### Transformação dos dados - Raiz quadrada\n\n```{r}\nmix4 <- lmer(sqrt(yield) ~ hybrid*method + block + (1|block/hybrid),\n            data = milho)\n```\n\n#### ANOVA - Dados transformados\n\n```{r}\nanova(mix4)\n```\n\n#### Avaliação das premissas - Dados transformados\n\n```{r}\ncheck_normality(mix4)\ncheck_heteroscedasticity(mix4)\n```\n\n#### Comparação de médias - Dados transformados\n\n##### Híbridos dentro de métodos:\n\n```{r}\nyield <- emmeans(mix4, ~ hybrid | method,\n                 type = \"response\")\ncld(index, Letters = LETTERS)\n```\n\n##### Métodos dentro de híbridos\n\n```{r}\nyield2 <- emmeans(mix4, ~ method | hybrid,\n                  type = \"response\")\ncld(index2, Letters = letters)\n```\n\n## Análise de Regressão Linear\n\n```{r}\nestande <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=401662555\")\n\nestande <- estande %>% \n  mutate(bloco = as.factor(bloco))\n```\n\n### Visualização gráfica\n\n```{r}\nestande %>% \n  ggplot(aes(trat, nplants))+\n  geom_jitter(width = 0.2, alpha = 0.2, color = \"darkred\")+\n  stat_summary(fun.data = \"mean_cl_boot\")+\n  geom_smooth(method = \"lm\", se = FALSE)+\n  facet_wrap(~exp)\n```\n\n```{r}\nestande %>% \n  ggplot(aes(trat, nplants))+\n  geom_jitter(width = 0.2, alpha = 0.2, color = \"darkred\")+\n  stat_summary(fun.data = \"mean_cl_boot\")+\n  geom_smooth(method = \"lm\", se = FALSE)\n```\n\n### Comparação por experimentos\n\n#### Exp. 1\n\n```{r}\nexp1 <- estande %>% \n  filter(exp == 1)\n\nexp1 %>% \n  ggplot(aes(trat, nplants))+\n  geom_point()+\n  ylim (0,100)+\n  geom_smooth(method = \"lm\", se = FALSE)\n```\n\n```{r}\nlm1 <- lm (nplants ~ trat,\n           data = exp1)\nsummary(lm1)\n```\n\n#### Exp. 2\n\n```{r}\nexp2 <- estande %>% \n  filter(exp == 2)\n\nexp2 %>% \n  ggplot(aes(trat, nplants))+\n  geom_point()+\n  ylim (0,100)+\n  geom_smooth (se = FALSE)+\n  geom_smooth(method = \"lm\", se = FALSE, color = \"red\")\n```\n\nUma opção para linearizar a curva seria aplicar log no tratamento (log(trat)).\n\n```{r}\nlm2 <- lm (nplants ~ trat,\n           data = exp2)\nsummary(lm2)\n```\n\n#### Exp. 3\n\n```{r}\nexp3 <- estande %>% \n  filter(exp == 3)\n\nexp1 %>% \n  ggplot(aes(trat, nplants))+\n  geom_point()+\n  ylim (0,100)+\n  geom_smooth(method = \"lm\", se = FALSE)\n```\n\n```{r}\nlm3 <- lm (nplants ~ trat,\n           data = exp3)\nsummary(lm3)\n```\n\n```{r}\nglm1 <- glm(nplants ~ trat,\n            family = \"gaussian\",\n            data = exp1)\n\nsummary(glm1)\nAIC(glm1)\n```\n\n```{r}\nglm2a <- glm(nplants ~ trat,\n            family = \"gaussian\",\n            data = exp2)\n\nsummary(glm2a)\nAIC(glm2a)\n```\n\n```{r}\nglm2b <- glm(nplants ~ trat,\n            family = poisson(link = \"log\"),\n            data = exp2)\n\nsummary(glm2b)\nAIC(glm2b)\n```\n\n```{r}\nglm3 <- glm(nplants ~ trat,\n            family = \"gaussian\",\n            data = exp3)\n\nsummary(glm3)\nAIC(glm3)\n```\n\n```{r}\nglm3b <- glm(nplants ~ trat,\n            family = poisson(link = \"log\"),\n            data = exp3)\n\nsummary(glm3b)\nAIC(glm3b)\n```\n\nAnálise dos experimento como um conjuto\n\n```{r}\nglm_exp <- glmer(nplants ~ trat + (trat | exp),\n            family = \"gaussian\",\n            data = estande)\n\nsummary(glm_exp)\nAIC(glm_exp)\n```\n\n```{r}\nglm_exp_2 <- glmer(nplants ~ trat + (trat | exp),\n            family = poisson(link = \"log\"),\n            data = estande)\n\nsummary(glm_exp_2)\nAIC(glm_exp_2)\n```\n\n\\_\\_\\_\n\n```{r}\n#| eval: false\ninstall.packages(\"pak\")\npak::pkg_install(\"Icens\")\npak::pkg_install(\"emdelponte/r4pde\")\n```\n\n```{r}\n#| eval: false\nremotes::install_github(\"emdelponte/r4pde\")\n```\n\n```{r}\nlibrary(r4pde)\nwm <- WhiteMoldSoybean\n\nwm %>% \n  ggplot (aes (inc, yld))+\n  geom_point()+\n  facet_wrap(~study)\n```\n\nCálculo de coeficiente angular para todos os ensaios\n\n```{r}\nwm %>% \n  ggplot (aes (inc, yld))+\n  geom_point()+\n  geom_smooth(method = \"lm\")\n\n\nmofo1 <- lm(yld ~ inc,\n            data = wm)\nsummary(mofo1)\n```\n\nCálculo de coeficiente angular para os ensaios individualmente\n\n```{r}\nwm %>% \n  ggplot (aes (inc, yld, group = factor(study)))+\n  geom_point()+\n  geom_smooth(method = \"lm\", se = F)\n```\n\n```{r}\nlibrary(broom)\nmofo2 <- wm %>% \n  group_by(study) %>% \n  do(tidy(lm(.$study ~ .$inc), conf.int = TRUE))\n\nmofo2\n```\n\n```{r}\ndf <- mofo2 %>% filter(term == \".$inc\")\nmean(df$estimate)\n```\n\n```{r}\np1 <- mofo2 %>% \n  filter(term == \"(Intercept)\") %>% \n  ggplot(aes(x = estimate))+\n  geom_histogram(bins = 8, color = \"white\", fill = \"gray50\")+\n  theme_r4pde()+\n  labs( x = \"Intercept\",\n        y = \"Frequency\")\n\np1\n```\n\n```{r}\np2 <- mofo2 %>% \n  filter(term == \".$inc\") %>%  \n  ggplot(aes(x = estimate))+\n  geom_histogram(bins = 8, color = \"white\", fill = \"gray50\")+\n  theme_r4pde()+\n  labs(x = \"Slope\", y = \"Frequency\")\n\np2\n```\n\n```{r}\nlibrary(patchwork)\n(p1+p2)\n```\n\nModelo misto\n\n```{r}\nmofo3 <- lmer(yld ~ inc + (inc | study), data = wm,\n              REML = F)\nsummary(mofo3)\n```\n","srcMarkdownNoYaml":"\n\n# Aula 9\n\n## Carregando pacotes\n\n```{r}\nlibrary(gsheet)\nlibrary(tidyverse)\nlibrary(lme4)\nlibrary(car)\nlibrary(performance)\nlibrary(DHARMa)\nlibrary(emmeans)\nlibrary(multcomp)\nlibrary(multcompView)\nlibrary(patchwork)\nlibrary(r4pde)\n```\n\n## Análise de um experimento em parcelas subdivididas\n\nExperimentos em parcelas subdivididas são utilizados quando o nível de um fator primário (ou tratamento) é aplicado a uma parcela relativamente grande e todos os níveis de um segundo fator secundário são aplicados às subparcelas desta parcela maior. Os tratamentos primários são distribuídos às parcelas de acordo com um delineamento especificado, já os tratamentos secundários são distribuídos às subparcelas de forma aleatória.\\\n\n## Importando os dados\n\nPara exemplificar a análise de um experimento em parcelas subdivididas, será utilizado um conjunto de dados onde o objetivo foi avaliar o índice de doença e produtividade de híbridos de milho (fator primário) ao serem submetidos a dois métodos de inoculação (fator secundário). Um esboço desse arranjo experimental é apresentado abaixo.\n\n![Experimento em parcelas subdivididas.](Imagem1.png){width=\"1650\"}\n\n```{r}\nmilho <- gsheet::gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1345524759\")\n```\n\n```{r}\nglimpse(milho)\n```\n\n## Visualização gráfica\n\n### Índice de doença\n\nPara visualização dos dados relacionados ao índice de doença e o método de inoculação será construído um gráfico de pontos (`geom_jitter`) acrescido do intervalo de confiança (`stat_summary(fund.data = \"mean_cl_boot\"`). Para gerar uma figura com os gráficos individuais de cada tratamento é utilizada a função `facet_wrap`.\n\n```{r}\nmilho %>% \n  ggplot(aes(method, index))+\n  geom_jitter(color = \"darkred\", width = 0.1, alpha = 0.4)+\n  stat_summary(fund.data = \"mean_cl_boot\", color = \"black\", width = 0.5)+\n  facet_wrap (~hybrid)\n```\n\n### Produtividade\n\nPara os dados relacionados à produtividade e o método de inoculação será construído um gráfico de similar ao anterior.\n\n```{r}\nmilho %>% \n  ggplot(aes(method, yield))+\n  geom_jitter(color = \"darkred\", width = 0.1, alpha = 0.4)+\n  stat_summary(fund.data = \"mean_cl_boot\", color = \"black\", width = 0.5)+\n  facet_wrap (~hybrid)\n```\n\n## Análise em parcelas subdivididas\n\n## Índice de doença (index)\n\n### Construção do modelo\n\nAntes de definir o modelo, será preciso transformar a coluna de dados \"block\" para fator (funções `mutate` e `as.factor`).\n\n```{r}\nmilho <- milho %>% \n  mutate(block = as.factor(block))\n```\n\nPara a análise dos dados, será construído um modelo linear de efeitos mistos com a função `lmer` (pacote **`lme4`**), onde definimos os fatores fixos e os fatores aleatórios.\n\n```{r}\nmix <- lmer(index ~ hybrid*method + block + (1|block/hybrid),\n            data = milho)\n```\n\n### ANOVA\n\n```{r}\nAnova(mix)\n```\n\nA análise de variância demonstra que há interação entre os fatores (hybrid:method). Assim seria preciso realizar os desdobramentos e comparar híbridos dentro de métodos e métodos dentro de híbridos. Mas antes, é preciso conferir se os dados atendem às pressuposições da ANOVA.\n\n### Avaliação das premissas\n\n```{r}\ncheck_normality(mix)\ncheck_heteroscedasticity(mix)\n```\n\n```{r}\nplot(simulateResiduals(mix))\n```\n\nCom as análises acima, conclui-se que os dados seguem distribuição normal. Porém, não há homogeneidade de variância entre os grupos. Logo será preciso uma alternativa para prosseguir a análise, por exemplo a transformação dos dados com raiz quadrada.\n\n### Transformação dos dados - Raiz quadrada\n\n```{r}\nmix2 <- lmer(sqrt(index) ~ hybrid*method + block + (1|block/hybrid),\n            data = milho)\n```\n\n#### ANOVA - Dados transformados\n\n```{r}\nanova(mix2)\n```\n\n#### Avaliação das premissas - Dados transformados\n\nCom as funções `check_normality` e `check_heteroscedasticity` (pacote **`Performance`**):\n\n```{r}\ncheck_normality(mix2)\ncheck_heteroscedasticity(mix2)\n```\n\nAtravés de um gráfico Q-Q (funções `qqnorm` e `qqline`):\n\n```{r}\nqqnorm(residuals(mix2))\nqqline(residuals(mix2))\n```\n\nCom a função `simulateResiduals` (pacote **`DHARMa`**):\n\n```{r}\nplot(simulateResiduals(mix2))\n```\n\nApesar da análise via **`DHARMa`** ter apresentado problemas, as demais avaliações (via **`Performance`** e QQ-Plot) se mostraram favoráveis, logo é possível prosseguir para a comparação de médias.\n\n#### Comparação de médias - Dados transformados\n\nComo visto pela ANOVA, há efeito de interação, logo será preciso realizar desdobramentos para as comparações:\n\n##### Híbridos dentro de métodos:\n\n```{r}\nindex <- emmeans(mix2, ~hybrid | method,\n                 type = \"response\")\n\ncld(index, Letters = LETTERS)\n```\n\n##### Métodos dentro de híbridos\n\n```{r}\nindex2 <- emmeans(mix2, ~method | hybrid,\n                  type = \"response\")\n\ncld(index2, Letters = letters)\n```\n\n## Produtividade (yield)\n\nSeguindo os mesmos procedimentos para o índice de doença, será conduzida avaliação da produtividade.\n\n### Construção do modelo\n\n```{r}\nmix3 <- lmer(yield ~ hybrid*method + block + (1|block/hybrid),\n            data = milho)\n```\n\n### ANOVA\n\n```{r}\nAnova(mix3)\n```\n\n### Avaliação das premissas\n\n```{r}\ncheck_normality(mix3)\ncheck_heteroscedasticity(mix3)\n```\n\nA análise pelas funções check_normality e check_heteroscedasticity demonstram que os dados possuem normalidade na distribuição dos resíduos, no entanto, não há homogeneidade de variância entre os grupos. Portanto, também será preciso realizar transformação.\n\n#### Transformação dos dados - Raiz quadrada\n\n```{r}\nmix4 <- lmer(sqrt(yield) ~ hybrid*method + block + (1|block/hybrid),\n            data = milho)\n```\n\n#### ANOVA - Dados transformados\n\n```{r}\nanova(mix4)\n```\n\n#### Avaliação das premissas - Dados transformados\n\n```{r}\ncheck_normality(mix4)\ncheck_heteroscedasticity(mix4)\n```\n\n#### Comparação de médias - Dados transformados\n\n##### Híbridos dentro de métodos:\n\n```{r}\nyield <- emmeans(mix4, ~ hybrid | method,\n                 type = \"response\")\ncld(index, Letters = LETTERS)\n```\n\n##### Métodos dentro de híbridos\n\n```{r}\nyield2 <- emmeans(mix4, ~ method | hybrid,\n                  type = \"response\")\ncld(index2, Letters = letters)\n```\n\n## Análise de Regressão Linear\n\n```{r}\nestande <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=401662555\")\n\nestande <- estande %>% \n  mutate(bloco = as.factor(bloco))\n```\n\n### Visualização gráfica\n\n```{r}\nestande %>% \n  ggplot(aes(trat, nplants))+\n  geom_jitter(width = 0.2, alpha = 0.2, color = \"darkred\")+\n  stat_summary(fun.data = \"mean_cl_boot\")+\n  geom_smooth(method = \"lm\", se = FALSE)+\n  facet_wrap(~exp)\n```\n\n```{r}\nestande %>% \n  ggplot(aes(trat, nplants))+\n  geom_jitter(width = 0.2, alpha = 0.2, color = \"darkred\")+\n  stat_summary(fun.data = \"mean_cl_boot\")+\n  geom_smooth(method = \"lm\", se = FALSE)\n```\n\n### Comparação por experimentos\n\n#### Exp. 1\n\n```{r}\nexp1 <- estande %>% \n  filter(exp == 1)\n\nexp1 %>% \n  ggplot(aes(trat, nplants))+\n  geom_point()+\n  ylim (0,100)+\n  geom_smooth(method = \"lm\", se = FALSE)\n```\n\n```{r}\nlm1 <- lm (nplants ~ trat,\n           data = exp1)\nsummary(lm1)\n```\n\n#### Exp. 2\n\n```{r}\nexp2 <- estande %>% \n  filter(exp == 2)\n\nexp2 %>% \n  ggplot(aes(trat, nplants))+\n  geom_point()+\n  ylim (0,100)+\n  geom_smooth (se = FALSE)+\n  geom_smooth(method = \"lm\", se = FALSE, color = \"red\")\n```\n\nUma opção para linearizar a curva seria aplicar log no tratamento (log(trat)).\n\n```{r}\nlm2 <- lm (nplants ~ trat,\n           data = exp2)\nsummary(lm2)\n```\n\n#### Exp. 3\n\n```{r}\nexp3 <- estande %>% \n  filter(exp == 3)\n\nexp1 %>% \n  ggplot(aes(trat, nplants))+\n  geom_point()+\n  ylim (0,100)+\n  geom_smooth(method = \"lm\", se = FALSE)\n```\n\n```{r}\nlm3 <- lm (nplants ~ trat,\n           data = exp3)\nsummary(lm3)\n```\n\n```{r}\nglm1 <- glm(nplants ~ trat,\n            family = \"gaussian\",\n            data = exp1)\n\nsummary(glm1)\nAIC(glm1)\n```\n\n```{r}\nglm2a <- glm(nplants ~ trat,\n            family = \"gaussian\",\n            data = exp2)\n\nsummary(glm2a)\nAIC(glm2a)\n```\n\n```{r}\nglm2b <- glm(nplants ~ trat,\n            family = poisson(link = \"log\"),\n            data = exp2)\n\nsummary(glm2b)\nAIC(glm2b)\n```\n\n```{r}\nglm3 <- glm(nplants ~ trat,\n            family = \"gaussian\",\n            data = exp3)\n\nsummary(glm3)\nAIC(glm3)\n```\n\n```{r}\nglm3b <- glm(nplants ~ trat,\n            family = poisson(link = \"log\"),\n            data = exp3)\n\nsummary(glm3b)\nAIC(glm3b)\n```\n\nAnálise dos experimento como um conjuto\n\n```{r}\nglm_exp <- glmer(nplants ~ trat + (trat | exp),\n            family = \"gaussian\",\n            data = estande)\n\nsummary(glm_exp)\nAIC(glm_exp)\n```\n\n```{r}\nglm_exp_2 <- glmer(nplants ~ trat + (trat | exp),\n            family = poisson(link = \"log\"),\n            data = estande)\n\nsummary(glm_exp_2)\nAIC(glm_exp_2)\n```\n\n\\_\\_\\_\n\n```{r}\n#| eval: false\ninstall.packages(\"pak\")\npak::pkg_install(\"Icens\")\npak::pkg_install(\"emdelponte/r4pde\")\n```\n\n```{r}\n#| eval: false\nremotes::install_github(\"emdelponte/r4pde\")\n```\n\n```{r}\nlibrary(r4pde)\nwm <- WhiteMoldSoybean\n\nwm %>% \n  ggplot (aes (inc, yld))+\n  geom_point()+\n  facet_wrap(~study)\n```\n\nCálculo de coeficiente angular para todos os ensaios\n\n```{r}\nwm %>% \n  ggplot (aes (inc, yld))+\n  geom_point()+\n  geom_smooth(method = \"lm\")\n\n\nmofo1 <- lm(yld ~ inc,\n            data = wm)\nsummary(mofo1)\n```\n\nCálculo de coeficiente angular para os ensaios individualmente\n\n```{r}\nwm %>% \n  ggplot (aes (inc, yld, group = factor(study)))+\n  geom_point()+\n  geom_smooth(method = \"lm\", se = F)\n```\n\n```{r}\nlibrary(broom)\nmofo2 <- wm %>% \n  group_by(study) %>% \n  do(tidy(lm(.$study ~ .$inc), conf.int = TRUE))\n\nmofo2\n```\n\n```{r}\ndf <- mofo2 %>% filter(term == \".$inc\")\nmean(df$estimate)\n```\n\n```{r}\np1 <- mofo2 %>% \n  filter(term == \"(Intercept)\") %>% \n  ggplot(aes(x = estimate))+\n  geom_histogram(bins = 8, color = \"white\", fill = \"gray50\")+\n  theme_r4pde()+\n  labs( x = \"Intercept\",\n        y = \"Frequency\")\n\np1\n```\n\n```{r}\np2 <- mofo2 %>% \n  filter(term == \".$inc\") %>%  \n  ggplot(aes(x = estimate))+\n  geom_histogram(bins = 8, color = \"white\", fill = \"gray50\")+\n  theme_r4pde()+\n  labs(x = \"Slope\", y = \"Frequency\")\n\np2\n```\n\n```{r}\nlibrary(patchwork)\n(p1+p2)\n```\n\nModelo misto\n\n```{r}\nmofo3 <- lmer(yld ~ inc + (inc | study), data = wm,\n              REML = F)\nsummary(mofo3)\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"Aula 9.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.553","editor":"visual","theme":"navbars","title":"Aula 9","author":"Caio"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}